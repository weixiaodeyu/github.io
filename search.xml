<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title></title>
    <url>%2Fposts%2F0%2F</url>
    <content type="text"><![CDATA[云私塾项目框架说明书 body{ margin: 0; } #content-info{ width: auto; margin: 0 auto; text-align: center; } #author-info{ white-space: nowrap; text-overflow: ellipsis; overflow: hidden; } #title{ text-overflow: ellipsis; white-space: nowrap; overflow: hidden; padding-top: 10px; margin-bottom: 2px; font-size: 34px; color: #505050; } .text{ white-space:nowrap; text-overflow: ellipsis; display: inline-block; margin-right: 20px; margin-bottom: 2px; font-size: 20px; color: #8c8c8c; } #navBar{ width: auto; height: auto; position: fixed; right:0; bottom: 0; background-color: #f0f3f4; overflow-y: auto; text-align: center; } #svg-container{ width: 100%; overflow-x: scroll; min-width: 0px; margin: 0 10px; } #nav-thumbs{ overflow-y: scroll; padding: 0 5px; } .nav-thumb{ position: relative; margin: 10px auto; } .nav-thumb >p{ text-align: center; font-size: 12px; margin: 4px 0 0 0; } .nav-thumb >div{ position: relative; display: inline-block; border: 1px solid #c6cfd5; } .nav-thumb img{ display: block; } #main-content{ bottom: 0; left: 0; right: 0; background-color: #d0cfd8; display: flex; height: auto; flex-flow: row wrap; text-align:center; } #svg-container >svg{ display: block; margin:10px auto; margin-bottom: 0; } #copyright{ bottom: 0; left: 50%; margin: 5px auto; font-size: 16px; color: #515151; } #copyright >a{ text-decoration: none; color: #77C; } .number{ position: absolute; top:0; left:0; border-top:22px solid #08a1ef; border-right: 22px solid transparent; } .pagenum{ font-size: 12px; color: #fff; position: absolute; top: -23px; left: 2px; } #navBar::-webkit-scrollbar{ width: 8px; background-color: #f5f5f5; } #navBar::-webkit-scrollbar-track{ -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,.3); border-radius: 8px; background-color: #fff; } #navBar::-webkit-scrollbar-thumb{ border-radius: 8px; -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,.3); background-color: #6b6b70; } #navBar::-webkit-scrollbar-thumb:hover{ background-color: #4a4a4f; } 云私塾项目框架说明书 ￠微笑的鱼… 2018-11-15 遇见更好的自己 延长用户的使用时长，增加用户被转化的机会 项目背景及发展侧重：已拥有相对充足的考生学员，成熟的市场流量来源，需求充足，所以优先重点构建流量的 内部流转结构及搭建专业课供给端的服务，后期依托于“内容+服务”构建新的流量模型。 功能模块1：学长学姐的资源储备，长尾工作，需不断完善专业课研究生的储备 合理设计专业课1v1辅导的课程，制定合理的服务交付规则，即可投入市场销售。（预收款、慢结转） 功能模块2，开发完成后，即可上线使用，开始数据沉淀。 功能模块3:，真题库的搭建和真题检索功能是同步进行的，审核通过入库的真题会即时更新到学员前端，并基于 用户信息进行定向提醒； 功能模块4，院校库数据的沉淀+院校检索服务，记录用户的行为数据，根据行为数据进行差异化、定制化营销； 功能模块5，主要服务于1v1的课时确认及交付监督； 理念：小步快跑，快速迭代，所有功能点均为拆分后的模块化，可独立开发独立上线，彼此互不影响； 基于大量用户数据，构建用户数据库，为精细化运营提供划分维度 基于用户量数据的运营及产品调整，结果导向 较重的前期固定投入，减轻后期的变动成本 云私塾 一、考研专业课市场特性 二、云私塾的目的和定位 A.产品的多样性 B.需求的分散性 a.842所研招单位，合计约5万个硕士招生专业 a.每年200余万的需求分散在45061个专业中;平均为4.4人/专业； b.99%的专业课为高校自主命题，考试内容不同； c.去重考试科目约为29896个，均有其独立的考试真题及配套资料，每年更新； 三、系统将带来的效益 1.目的：护城河，平台生态 d.相同专业、相同参考书，其考试内容也存在倾向性； b.专业的报考人数和招录人数波动极大，1-1000； C.同一区域考生报考目的极度分散，无法有效聚拢用户，无法规模化； 1.专业课市场的典型特点 2.专业课市场的典型需求 A.选校选专业的指导（也可说是职业生涯规划的指导）； B.自命题专业课考研真题/笔记； D.非透明的资讯 C.专业课考试内容的辅导； a.如何确定专业？如何确定合适的学校？ b.学校的专业实力，专业的就业方向； C.行业的发展情况，最前沿的学科动态； a.自命题专业课真题； b.专业课配套的辅导资料； a.考试重难点划分； b.教材知识点结构梳理； c.备考策略的制定； d.知识点的讲解； e.真题的讲解答疑； a.复试形式+内容； b.报录比 c.初试分数线； d.导师的能力、为人、学术品质的信息； 引子：背景 A.护城河； 1.考研市场的现行特点 A.产品同质化； C.名师效应突出； D.选择多元，流量萎缩； a.政治、英语、数学的直播、录播课程； b.线下集训营； c.大班课； B.竞争白热化； a.新东方：公共课 b.文都：综合型 c.跨考：综合型 d.学府：综合型 e.新祥旭：专业课，专注微信生态 g.考虫：公共课 h.中公：公共课 i.粉笔：公共课 l.海文 f.V研客：公共课供应商 j.网易有道考神团队：公共课，开始专业课的探索 k.沪江张雪峰团队：公共课 a.公共课及统考科目的名师自带流量； b.名师管理难度加大，且不再满足于固定签约某个机构； a.用户获取信息的渠道多元化，流量获取困难； b.同类产品众多，分散用户注意力； 2.考研市场的机会 A.需求不断增长； B.精细化服务欠缺； C.专业课服务基本为空白； a.考研人数持续攀升； b.名校竞争越来越激烈； c.高校信息越来越闭塞； a.粗放的圈地收钱； b.学习效果外化不明显； c.用户对服务感知弱； a.品类：用户需求的满足能力； b.服务：精细化运营； c.规模:业务规模/资源储备； B.平台 a.数据：基于用户属性、行为等数据的精细化运营； b.流量：基于刚需产品构建流量循环模型； 2.云私塾定位：考研一站式服务平台 A.资讯 a.公共课； b.专业课； a.政策和资讯； C.价值需求 B.陪伴 b.院校查询及检索； c.资料检索； a.学长的指导； b.研友的交流和陪伴； c.平台/老师的鼓励和帮助； c.内容流转：基于用户实际需要，智能化的内容生态； 1.业务聚合 A.增加一条营收路径 2.流量模型 3.构筑壁垒 a.专业课1v1； b.试题讲解； c.复试辅导； d.打包后的其他新型产品； A.流量的转化模型 B.流量的自增长模型 m.海天 四、项目落地的节奏及目标 step1.研究生入驻系统 1.业务节奏：业务规范化的步骤 B.强化产品之间的联动关系 a.基于用户行为更智能的课程推荐； b.基于用户数据的针对性电销； c.利用用户数据指导教研产出； 五、基础功能点的产品实现规划 a.增加用户活跃，提升曝光率； b.增加用户留存，提升触达机会； a.裂变； A.规模壁垒； B.资源壁垒； C.先发优势； D.逻辑+运营壁垒； step2.问答功能 step4.院校信息检索功能 step3.真题回收及检索 step5.1v1课时确认 A.意义 B.作用 a.研究生作为专业课业务中的核心服务供给来源，为所有服务的先决条件； 规模效应，会形成天然壁垒； 专业课领域的资源收集整合难度极大； 专业课将是考研市场后期必争之地，先布局则容易形成先发优势； 逻辑环节设计+运营策略形成联合壁垒，留住用户； a.为1v1服务的供给作资源储备； b.为学员提供“高频轻量级”的问答服务，提高用户对平台的粘性，活跃用户，增加留存,增加转化用户的机会； D.进度 系统开发已完成，正在招募研究生入驻； C.时间规划 2018年10月1日-10月31日 F.推向学员的标准 G.需要的资源支持 至少3000名主流高校入驻研究生； a.招募资金（早期投入）：约20-30元/个有效入驻（需手机号验证+证件上传+资料补充，约等于下载一个APP的 注册，市场激活价格约为30-50元）； b.日常运营：新媒体运营、用户运营； C.渠道推广：通过线上（自媒体矩阵、朋友圈广告等）、线下（校园大使）可用渠道快速招募研究生入驻； c.协助补充学校信息中的非公开信息（参考书、报录比、真题笔记等）； b.研究生是商业价值的核心载体； A.意义 B.作用 a.促进研究生的留存和活跃； a.0-10元/问答，解决学员轻量级的需求，为研究生创造可持续的、可见的收益； b.增加用户进入系统的频次，增进用户对品牌、产品的认知，增加营销机会； D.进度 文档已完成，待开发； C.时间规划 2018年11月-12月（如果技术排期不耽误的情况下） F.推向学员的标准 G.需要的资源支持 问答交互、支付流程测试验收后即可交付学员使用 a.开发支持； b.日常运营：问答的管理、新媒体运营； C.渠道推广：学员端的小范围推广； c.依赖于社交，让用户感受到平台温度，产生情感粘性，促进口碑建设； b.促进学员的留存和活跃； 属性 辅助功能，资源储备 c.口碑传播和平台价值的一个载体； 属性 业务性功能，完成后即可独立上线 d.沉淀问答数据，形成专业课领域最具价值的UGC社区，同时又具备各专业垂直的UGC社区； d.问答产生的数据可以保证绝大多数为高价值数据沉淀，具备内容价值；基于内容分析，可以为运营策略提供指 导； A.意义 B.作用 a.真题作为考研的极刚性需求，不需要服务的同学也需要通过真题来模拟考试；（国内应试的惯性） a.聚拢流量； b.不断完善的真题库，可以给用户一个希望，增加用户的活跃和留存； D.进度 文档已完成，待开发； C.时间规划 2018年12月（如果技术排期不耽误的情况下） F.推向学员的标准 G.需要的资源支持 开发完成，回收渠道稳定后，即可面向学员，预计5000份真题； a.开发支持； b.日常运营：真题审核及管理、传题大使的管理及结算； C.渠道推广：真题回收系统的推广漏出； c.轻量级产品，可以作为引流载体设计流量裂变模型； b.题库，作为资源型产品，具备自带流量的属性； c.可以形成资源壁垒，进一步强化聚拢流量的能力； 属性 辅助功能+业务型功能点，完成后即可独立上线 A.意义 B.作用 a.专业的多样性造成选择多样性，如何做选择是考生关注的问题； a.聚拢流量； b.权威的信息数据，有利于树立业务的权威形象； D.进度 待进行框架思考及准备文档和原型 C.时间规划 2019年1月（如果技术排期不耽误的情况下） F.推向学员的标准 G.需要的资源支持 系统框架完成，375个二级学科的基础信息储备完善（具体需要哪些数据见详情文档）； a.开发支持； b.日常运营：375个二级学科的信息准备 c.院校结构完美适配其他内容的展示结构，基于院校库建设内容展示结构； b.已有的研招网及其他院校库类型网站，信息单一落后； c.选校容易塑造权威形象，向考生灌输认知； 属性 业务型功能，完成后即可独立上线 A.意义 B.作用 a.专业的多样性造成选择多样性，如何做选择是考生关注的问题； a.聚拢流量； b.权威的信息数据，有利于树立业务的权威形象； D.进度 待进行框架思考及准备文档和原型 C.时间规划 2019年1月（如果技术排期不耽误的情况下） F.推向学员的标准 G.需要的资源支持 系统框架完成，375个二级学科的基础信息储备完善（具体需要哪些数据见详情文档）； a.开发支持； b.日常运营：375个二级学科的信息准备 c.院校结构完美适配其他内容的展示结构，基于院校库建设内容展示结构； b.已有的研招网及其他院校库类型网站，信息单一落后； c.选校容易塑造权威形象，向考生灌输认知； 属性 业务功能，完成后即可独立上线 六、基于数据的精细化运营——“降本提效” c.结合运营及电销等的流量转化模型； p.市场上其他团队 A.业务先行； B.资源储备； C.服务标准化节奏； a.构筑标准化1v1辅导的课程，可以脱离于系统优先上线销售； a.服务流程标准化：清晰明了的业务交付管理路径，例如怎样付钱、怎样上课、怎样约课、怎样支付酬劳、这样 对账的路程； 3,时间节奏：功能上线时间 4.具备基础服务能力的数据指标及目标 b.先销售，后交付（教育服务特性：预付款、慢结转）； c.合理的收费及交付规则，预留交付时间、无法完成交付的处理方案等； a.院校库资料信息的准备； b.研究生的招录，研究生库的搭建； c.真题的回收上架，真题库的搭建； b.服务方式标准化：标准化的服务交付场景，例如使用平台的辅导系统等； c.服务内容的标准化：标准化的服务内容，例如课件内容、讲授方式等； d.全流程精细化运营：全流程可掌控的情况下，根据用户反馈进行的精细化运营； a,1v1的课程销售可以独立于系统优先上线； b.研究生入驻系统，2018年10月28日已上线； C.考生-研究生问答交互系统，2018年11月-12月开发上线； 预计可以实现20考季通过该系统实现营收4000万（如果能按照既定规划完成资源储备及功能开发） d.真题的回收检索系统，2018年12月-2019年1月上线； e.院校库系统，2019年1月开发上线； f.1v1辅导系统，2019年3月开发上线； g.基础功能完善，2019年3月份； A.服务20考季的资源要求（最晚5月份前） a.研究生覆盖5000个专业； b.真题3万份； c.院校库375个专业内容齐备； B.营收目标 1.用户建模 A.用户属性特征 B.用户行为特征 a.地区 b.性别 c.本科院校专业 d.目标院校专业 e.毕业年份 a.院校检索 b.公共课体验及检索 c.专业课提问 d.专业课服务检索 e.收藏行为 f.转发行为 2.定向营销 A.课程 B.曝光 C.用户活跃度 a.DAU b.MAU c.0.033&lt;Dau/Mau&lt;1 a.班课开设哪些专业，优先顺序； b.课程价值预估及价格设定（Bep计算）； c.课程内容如何设置（课程亮点/特色）； a.页面差异化； b.文案差异化； c.引导差异化； 3.学习效果可视化 A.“讲练测评”体系 B.学习效果大数据 a.讲：知识点的课程讲解； b.练：基于课程内容的配套练习，类似于课后作业，对刚学习的内容进行检测； d.评：对测试结果进行反馈； c.测：定期的模拟测试，对整体进度有个了解； C.学习报告 a.根据练、评数据对用户分级； b.根据分级结果，进行针对性营销； c.根据练、评结果，及学习行为数据，优化修正课程设计； d.在练评过程中，进行用户的某些报课线索收集； a.在关键事件节点上，对用户的学习效果进行报告式反馈； b.记录用户的学习行为，根据学习行为及效果，可以定期进行学员关怀； n.圣才考研网：专业课资料为主 o.厦门研途教育集团：专业课资料为主 Created With MindMaster eval(atob('dmFyIG11YT13aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDsNCnZhciB1YT0obXVhLmluZGV4T2YoJ3J2OjExJykrbXVhLmluZGV4T2YoJ01TSUUnKSk+PTA7DQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ZnLWNvbnRhaW5lcicpLm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KfQ0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N2Zy1jb250YWluZXInKS5vbm1vdXNlZG93biA9IGZ1bmN0aW9uIChldmVudCkgew0KICAgIGlmKGV2ZW50LndoaWNoID09Myl7DQogICAgICAgIHRoaXMuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgICAgICB0aGlzLm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gKGV2KSB7DQogICAgICAgICAgICB0aGlzLnNjcm9sbEJ5KC0oZXYubW92ZW1lbnRYKSwgMCk7DQogICAgICAgICAgICB3aW5kb3cuc2Nyb2xsQnkoMCwtKGV2Lm1vdmVtZW50WSkpDQogICAgICAgIH0NCiAgICAgICAgdGhpcy5vbm1vdXNldXAgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLnN0eWxlLmN1cnNvciA9ICBudWxsOw0KICAgICAgICAgICAgdGhpcy5vbm1vdXNldXAgPSBudWxsOw0KICAgICAgICAgICAgdGhpcy5vbm1vdXNlbW92ZSA9IG51bGw7DQogICAgICAgIH0NCiAgICB9DQp9DQpOdW1iZXIucHJvdG90eXBlLnRvc3VpdHN2Zz1mdW5jdGlvbiAoKSB7DQogICAgdmFyIG51bT10aGlzLnZhbHVlT2YoKTsNCiAgICBpZihudW0lMT09PTApew0KICAgICAgICByZXR1cm4gbnVtKzAuNQ0KICAgIH1lbHNlIHJldHVybiBudW07DQp9Ow0KTnVtYmVyLnByb3RvdHlwZS5wbHVzej1mdW5jdGlvbigpIHsNCiAgICB2YXIgbnVtPXRoaXMudmFsdWVPZigpOw0KICAgIHJldHVybiBudW08MTA/JzAnK251bTpudW07DQp9Ow0KZnVuY3Rpb24gcGFyc2VEYXRlKG51bSkgew0KICAgIHZhciBkYXRlID0gbmV3IERhdGUobnVtKTsNCiAgICB2YXIgWSA9IGRhdGUuZ2V0RnVsbFllYXIoKSArICctJzsNCiAgICB2YXIgTSA9IChkYXRlLmdldE1vbnRoKCkrMSkucGx1c3ooKSArICctJzsNCiAgICB2YXIgRCA9IGRhdGUuZ2V0RGF0ZSgpLnBsdXN6KCkgKyAnICc7DQogICAgdmFyIGggPSBkYXRlLmdldEhvdXJzKCkucGx1c3ooKSArICc6JzsNCiAgICB2YXIgbW0gPSBkYXRlLmdldE1pbnV0ZXMoKS5wbHVzeigpICsgJzonOw0KICAgIHZhciBzID0gZGF0ZS5nZXRTZWNvbmRzKCkucGx1c3ooKTsNCiAgICByZXR1cm4gWStNK0QraCttbStzOw0KfQ0KLy8tLXByZWRlZmluZWQNCi8vY29tbWVudC0tDQp2YXIgY29tbWVudHM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZz5nW2VkXFw6Y29tbWVudF0nKTsNCmZ1bmN0aW9uIGdldGN3aChwb3B1cCkgew0KICAgIGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N2ZycpWzBdLmFwcGVuZENoaWxkKHBvcHVwKTsNCiAgICB2YXIgdz1wb3B1cC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDsNCiAgICB2YXIgaD1wb3B1cC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7DQogICAgcmV0dXJuIFt3LGhdDQp9DQpmb3IodmFyIGk9MDtpPGNvbW1lbnRzLmxlbmd0aDtpKyspew0KICAgIHZhciBwb3B1cD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywnZycpOw0KICAgIHZhciBwb3B1cFI9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgdmFyIGhvdmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgdmFyIG9saW5lPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCdmaWxsJywnI2NkY2RmZicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgneCcsJzAnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3knLCcwJyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCcxNicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCcxNicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnZmlsbC1vcGFjaXR5JywnMC42Jyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nLGNvbW1lbnRzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3VzZScpLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJykpOw0KICAgIGhvdmVyLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIGNvbW1lbnRzW2ldLmFwcGVuZENoaWxkKGhvdmVyKTsNCiAgICB2YXIgYT1KU09OLnBhcnNlKGNvbW1lbnRzW2ldLmdldEF0dHJpYnV0ZSgnZWQ6Y29tbWVudCcpKTsNCiAgICB2YXIgaGVpZ2h0PTA7DQogICAgdmFyIGNhcnI9W107DQogICAgZm9yKHZhciBqPTA7ajxhLmxlbmd0aDtqKyspew0KICAgICAgICB2YXIgc3RhbXA9TnVtYmVyKGFbal0uRGF0ZSkqMTAwMDsNCiAgICAgICAgdmFyIHRpbWU9cGFyc2VEYXRlKHN0YW1wKTsNCiAgICAgICAgdmFyIG5hbWU9YVtqXS5OYW1lOw0KICAgICAgICB2YXIgbWVzc2FnZT1hW2pdLk1lc3NhZ2U7DQogICAgICAgIHZhciBtZXNzYWdlQXJyPW1lc3NhZ2Uuc3BsaXQoL1xuLyk7DQogICAgICAgIHZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdnJyk7DQogICAgICAgIHZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIHZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIHZhciBtPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIG4uc2V0QXR0cmlidXRlKCd4Jyw1KTsNCiAgICAgICAgbi5zZXRBdHRyaWJ1dGUoJ3knLDEyKTsNCiAgICAgICAgbi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCcjMDA2ZWZmJyk7DQogICAgICAgIG4udGV4dENvbnRlbnQ9bmFtZSsn77yaJzsNCiAgICAgICAgbi5zZXRBdHRyaWJ1dGUoJ2ZvbnQtc2l6ZScsJzEyJyk7DQogICAgICAgIHQuc2V0QXR0cmlidXRlKCd4JywyMDApOw0KICAgICAgICB0LnNldEF0dHJpYnV0ZSgneScsMTIpOw0KICAgICAgICB0LnNldEF0dHJpYnV0ZSgnZmlsbCcsJyM5Njk2OTYnKTsNCiAgICAgICAgdC50ZXh0Q29udGVudD10aW1lOw0KICAgICAgICB0LnNldEF0dHJpYnV0ZSgnZm9udC1zaXplJywnMTAnKTsNCiAgICAgICAgbS5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsJ3RyYW5zbGF0ZSgyMCwyNyknKTsNCiAgICAgICAgbS5zZXRBdHRyaWJ1dGUoJ2ZvbnQtc2l6ZScsJzEyJyk7DQogICAgICAgIGZvcih2YXIgaz0wO2s8bWVzc2FnZUFyci5sZW5ndGg7aysrKXsNCiAgICAgICAgICAgIHZhciB0cz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywndHNwYW4nKTsNCiAgICAgICAgICAgIHRzLnNldEF0dHJpYnV0ZSgneCcsJzAnKTsNCiAgICAgICAgICAgIHRzLnNldEF0dHJpYnV0ZSgneScsayoxNik7DQogICAgICAgICAgICB0cy50ZXh0Q29udGVudD1tZXNzYWdlQXJyW2tdOw0KICAgICAgICAgICAgbS5hcHBlbmRDaGlsZCh0cyk7DQogICAgICAgIH0NCiAgICAgICAgby5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsJ3RyYW5zbGF0ZSgwLCcraGVpZ2h0KycpJyk7DQogICAgICAgIG8uYXBwZW5kQ2hpbGQobik7DQogICAgICAgIG8uYXBwZW5kQ2hpbGQodCk7DQogICAgICAgIG8uYXBwZW5kQ2hpbGQobSk7DQogICAgICAgIGNhcnIucHVzaChvKTsNCiAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQobyk7DQogICAgICAgIGhlaWdodD0obWVzc2FnZUFyci5sZW5ndGgrMSkqMTYraGVpZ2h0Ow0KICAgIH0NCiAgICB2YXIgd2Fycj1nZXRjd2gocG9wdXApOw0KICAgIG9saW5lLnNldEF0dHJpYnV0ZSgneCcsJzAnKTsNCiAgICBvbGluZS5zZXRBdHRyaWJ1dGUoJ3knLCcwJyk7DQogICAgdmFyIG93PXdhcnJbMF0rMTAuNTsNCiAgICB2YXIgb2g9d2FyclsxXSszOw0KICAgIG9saW5lLnNldEF0dHJpYnV0ZSgnd2lkdGgnLG93KTsNCiAgICBvbGluZS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsb2gpOw0KICAgIG9saW5lLnNldEF0dHJpYnV0ZSgnZmlsbCcsJ3doaXRlJyk7DQogICAgb2xpbmUuc2V0QXR0cmlidXRlKCdzdHJva2UnLCcjNjU2NTY1Jyk7DQogICAgcG9wdXAuYXBwZW5kQ2hpbGQob2xpbmUpOw0KICAgIHZhciBsPWNhcnIubGVuZ3RoOw0KICAgIHdoaWxlKGwtLSl7DQogICAgICAgIHBvcHVwLmFwcGVuZENoaWxkKGNhcnJbbF0pOw0KICAgIH0NCiAgICBwb3B1cC5vbm1vdXNlb3Zlcj1mdW5jdGlvbiAoKSB7DQogICAgICAgIHRoaXMuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgIH07DQogICAgcG9wdXAub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQogICAgICAgIHRoaXMuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9Ow0KICAgIHZhciBjcz1jb21tZW50c1tpXS5xdWVyeVNlbGVjdG9yKCd1c2UnKS5nZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScpLm1hdGNoKC9cKChcUyp8XFMqXHNcUyopXCkvKVsxXS5zcGxpdCgvIHwsLyk7DQogICAgdmFyIHBzPWNvbW1lbnRzW2ldLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nKTsNCiAgICBpZihwcy5zdWJzdHIoMCwyKSA9PSAndHInKXsNCiAgICAgICAgdmFyIHBwcyA9IHBzLm1hdGNoKC9cKChcUyp8XFMqXHNcUyopXCkvKVsxXS5zcGxpdCgvIHwsLyk7DQogICAgICAgIHZhciB4PXBhcnNlRmxvYXQoY3NbMF0pK3BhcnNlRmxvYXQocHBzWzBdKTsNCiAgICAgICAgdmFyIHk9cGFyc2VGbG9hdChwcHNbMV0pOw0KICAgICAgICB4PXgudG9zdWl0c3ZnKCk7DQogICAgICAgIHk9eS50b3N1aXRzdmcoKTsNCiAgICAgICAgdmFyIHRyc3RyID0gJ3RyYW5zbGF0ZSgnK3grJywnK3krJyknOw0KICAgIH0NCiAgICBlbHNlIGlmKHBzLnN1YnN0cigwLDIpID09ICdtYScpew0KICAgICAgICB2YXIgcHBzID0gcHMubWF0Y2goLyhcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylcKSQvKTsNCiAgICAgICAgdmFyIG1hQXJyID0gW3BhcnNlRmxvYXQocHBzWzFdKSxwYXJzZUZsb2F0KHBwc1szXSkscGFyc2VGbG9hdChwcHNbNV0pLHBhcnNlRmxvYXQocHBzWzddKSxwYXJzZUZsb2F0KHBwc1s5XSkscGFyc2VGbG9hdChwcHNbMTFdKV07DQogICAgICAgIGlmKG1hQXJyWzFdID09IDApew0KICAgICAgICAgICAgdmFyIHggPSBwYXJzZUZsb2F0KGNzWzBdKTsNCiAgICAgICAgICAgIHZhciB5PSAwOw0KICAgICAgICAgICAgdmFyIHgxID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTEgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHgxPXgxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgeTE9eTEudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICB2YXIgdHJzdHIgPSAgJ3RyYW5zbGF0ZSgnK3gxKycsJyt5MSsnKSc7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdmFyIHggPSBwYXJzZUZsb2F0KGNzWzBdKSsxNjsNCiAgICAgICAgICAgIHZhciB5PSAwOw0KICAgICAgICAgICAgdmFyIHgxID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTEgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHggPSBwYXJzZUZsb2F0KGNzWzBdKSsxNjsNCiAgICAgICAgICAgIHk9IC0xNjsNCiAgICAgICAgICAgIHZhciB4MiA9IHggKiBtYUFyclswXSArIHkgKiBtYUFyclsyXSArIG1hQXJyWzRdOw0KICAgICAgICAgICAgdmFyIHkyID0geCAqIG1hQXJyWzFdICsgeSAqIG1hQXJyWzNdICsgbWFBcnJbNV07DQogICAgICAgICAgICB2YXIgZnggPSB4MTx4Mj94MS50b3N1aXRzdmcoKTogeDIudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICB2YXIgZnkgPSB5MT55Mj95MS50b3N1aXRzdmcoKTogeTIudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICB2YXIgb2ZmeSA9IE1hdGguYWJzKHkxLXkyKTsNCiAgICAgICAgICAgIHZhciB0cnN0ciA9ICAndHJhbnNsYXRlKCcrZngrJywnK2Z5KycpJzsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsb2ZmeS50b1N0cmluZygpKTsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywnMTYnKTsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ3knLCgtb2ZmeSkudG9TdHJpbmcoKSk7DQogICAgICAgICAgICBwb3B1cFIuc2V0QXR0cmlidXRlKCdmaWxsJywndHJhbnNwYXJlbnQnKTsNCiAgICAgICAgICAgIHBvcHVwLmFwcGVuZENoaWxkKHBvcHVwUik7DQogICAgICAgIH0NCiAgICB9DQogICAgcG9wdXAuc2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nLHRyc3RyKTsNCiAgICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ2NvbW1lbnQnLCcnKTsNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ2VkOmNvbW1lbnRpZCcsY29tbWVudHNbaV0ucGFyZW50Tm9kZS5pZCk7DQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N2Zy1jb250YWluZXIgPiBzdmcnKS5hcHBlbmRDaGlsZChwb3B1cCk7DQogICAgY29tbWVudHNbaV0ub25tb3VzZW92ZXI9ZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgY29tbWVudGlkPXRoaXMucGFyZW50Tm9kZS5pZDsNCiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCdyZWN0Jykuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6Y29tbWVudGlkPSciK2NvbW1lbnRpZCsiJ11bY29tbWVudF0iKS5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgfTsNCiAgICBjb21tZW50c1tpXS5vbm1vdXNlb3V0PWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIGNvbW1lbnRpZD10aGlzLnBhcmVudE5vZGUuaWQ7DQovLyAgICAgICAgd2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpOw0KICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOmNvbW1lbnRpZD0nIitjb21tZW50aWQrIiddW2NvbW1lbnRdIikuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgfQ0KfQ0KLy8tLWNvbW1lbnQNCi8vbm90ZS0tDQppZighdWEpew0KICAgIHZhciBub3Rlcz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdnPmdbZWRcXDpub3RlXScpOw0KICAgIGZ1bmN0aW9uIGdldHdoKHMscCkgew0KICAgICAgICB2YXIgbWFpbnA9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgIG1haW5wLnN0eWxlLmNzc1RleHQ9czsNCiAgICAgICAgbWFpbnAuc3R5bGUuZGlzcGxheT0naW5saW5lLWJsb2NrJzsNCiAgICAgICAgbWFpbnAuaW5uZXJIVE1MPXA7DQogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWFpbnApOw0KICAgICAgICB2YXIgdz1tYWlucC5jbGllbnRXaWR0aDsNCiAgICAgICAgdmFyIGg9bWFpbnAuY2xpZW50SGVpZ2h0Ow0KICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG1haW5wKTsNCiAgICAgICAgcmV0dXJuIFt3LGhdDQogICAgfQ0KICAgIGZvcih2YXIgaT0wO2k8bm90ZXMubGVuZ3RoO2krKyl7DQogICAgICAgIHZhciBhPW5vdGVzW2ldLmdldEF0dHJpYnV0ZSgnZWQ6bm90ZScpOw0KCQl2YXIgbm90ZUxvY2sgPSBub3Rlc1tpXS5nZXRBdHRyaWJ1dGUoJ2VkOm5vdGVsb2NrJyk7DQogICAgICAgIGlmKG5vdGVMb2NrID09ICd0cnVlJyl7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgbWFpbnA9YS5tYXRjaCgvPHAoW1xTXHNdKik8XC9wPi9nKVswXTsNCiAgICAgICAgdmFyIG1haW5zPWEubWF0Y2goL3N0eWxlPSIoLio/KSIvKVsxXTsNCiAgICAgICAgdmFyIG91dD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywnZycpOw0KICAgICAgICB2YXIgb2xpbmU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ3JlY3QnKTsNCiAgICAgICAgdmFyIHBvcHVwPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdmb3JlaWduT2JqZWN0Jyk7DQogICAgICAgIHZhciBwb3B1cFI9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgICAgIHZhciBob3Zlcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywncmVjdCcpOw0KICAgICAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCcjY2RjZGZmJyk7DQogICAgICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgneCcsJzAnKTsNCiAgICAgICAgaG92ZXIuc2V0QXR0cmlidXRlKCd5JywnMCcpOw0KICAgICAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsJzE2Jyk7DQogICAgICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCcxNicpOw0KICAgICAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ2ZpbGwtb3BhY2l0eScsJzAuNicpOw0KICAgICAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsbm90ZXNbaV0ucXVlcnlTZWxlY3RvcigndXNlJykuZ2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nKSk7DQogICAgICAgIGhvdmVyLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgICAgICBub3Rlc1tpXS5hcHBlbmRDaGlsZChob3Zlcik7DQogICAgICAgIHBvcHVwLnN0eWxlLmNzc1RleHQ9bWFpbnM7DQogICAgICAgIHBvcHVwLmlubmVySFRNTD1tYWlucDsNCiAgICAgICAgdmFyIHdoPWdldHdoKG1haW5zLG1haW5wKTsNCiAgICAgICAgcG9wdXAuc2V0QXR0cmlidXRlKCd3aWR0aCcsd2hbMF0rMTYpOw0KICAgICAgICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsd2hbMV0rOCk7DQogICAgICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJywndHJhbnNsYXRlKDgsNCknKTsNCiAgICAgICAgcG9wdXAuc3R5bGUudGV4dEFsaWduPSdsZWZ0JzsNCiAgICAgICAgb2xpbmUuc2V0QXR0cmlidXRlKCd4JywnMCcpOw0KICAgICAgICBvbGluZS5zZXRBdHRyaWJ1dGUoJ3knLCcwJyk7DQogICAgICAgIG9saW5lLnNldEF0dHJpYnV0ZSgnd2lkdGgnLHdoWzBdKzE2KTsNCiAgICAgICAgb2xpbmUuc2V0QXR0cmlidXRlKCdoZWlnaHQnLHdoWzFdKzgpOw0KICAgICAgICBvbGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsJyNhMjdhMDAnKTsNCiAgICAgICAgb2xpbmUuc2V0QXR0cmlidXRlKCdmaWxsJywnI2ZmZTc5ZCcpOw0KICAgICAgICBvdXQuYXBwZW5kQ2hpbGQob2xpbmUpOw0KICAgICAgICBvdXQuYXBwZW5kQ2hpbGQocG9wdXApOw0KICAgICAgICBvdXQuc2V0QXR0cmlidXRlKCdub3RlJywnJyk7DQogICAgICAgIG91dC5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgb3V0LnNldEF0dHJpYnV0ZSgnZWQ6bm90ZWlkJyxub3Rlc1tpXS5wYXJlbnROb2RlLmlkKTsNCiAgICAgICAgb3V0Lm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgICB9Ow0KICAgICAgICBvdXQub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQovLyAgICAgICAgd2luZG93LmdldFNlbGVjdGlvbiA/IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVSYW5nZSh3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmUpOmRvY3VtZW50LnNlbGVjdGlvbi5lbXB0eSgpOw0KDQogICAgICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgICAgICB9Ow0KICAgICAgICB2YXIgY3M9bm90ZXNbaV0ucXVlcnlTZWxlY3RvcigndXNlJykuZ2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nKS5tYXRjaCgvXCgoXFMqfFxTKlxzXFMqKVwpLylbMV0uc3BsaXQoLyB8LC8pOw0KICAgICAgICB2YXIgcHM9bm90ZXNbaV0ucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScpOw0KICAgICAgICBpZihwcy5zdWJzdHIoMCwyKSA9PSAndHInKXsNCiAgICAgICAgICAgIHZhciBwcHMgPSBwcy5tYXRjaCgvXCgoXFMqfFxTKlxzXFMqKVwpLylbMV0uc3BsaXQoLyB8LC8pOw0KICAgICAgICAgICAgdmFyIHg9cGFyc2VGbG9hdChjc1swXSkrcGFyc2VGbG9hdChwcHNbMF0pOw0KICAgICAgICAgICAgdmFyIHk9cGFyc2VGbG9hdChwcHNbMV0pOw0KICAgICAgICAgICAgeD14LnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgeT15LnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgdmFyIHRyc3RyID0gJ3RyYW5zbGF0ZSgnK3grJywnK3krJyknOw0KICAgICAgICB9ZWxzZSBpZihwcy5zdWJzdHIoMCwyKSA9PSAnbWEnKXsNCiAgICAgICAgICAgIHZhciBwcHMgPSBwcy5tYXRjaCgvKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVwpJC8pOw0KICAgICAgICAgICAgdmFyIG1hQXJyID0gW3BhcnNlRmxvYXQocHBzWzFdKSxwYXJzZUZsb2F0KHBwc1szXSkscGFyc2VGbG9hdChwcHNbNV0pLHBhcnNlRmxvYXQocHBzWzddKSxwYXJzZUZsb2F0KHBwc1s5XSkscGFyc2VGbG9hdChwcHNbMTFdKV07DQogICAgICAgICAgICBpZihtYUFyclsxXSA9PSAwKXsNCiAgICAgICAgICAgICAgICB2YXIgeCA9IHBhcnNlRmxvYXQoY3NbMF0pOw0KICAgICAgICAgICAgICAgIHZhciB5PSAwOw0KICAgICAgICAgICAgICAgIHZhciB4MSA9IHggKiBtYUFyclswXSArIHkgKiBtYUFyclsyXSArIG1hQXJyWzRdOw0KICAgICAgICAgICAgICAgIHZhciB5MSA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgICAgIHgxPXgxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgICAgIHkxPXkxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgICAgIHZhciB0cnN0ciA9ICAndHJhbnNsYXRlKCcreDErJywnK3kxKycpJzsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIHZhciB4ID0gcGFyc2VGbG9hdChjc1swXSkrMTY7DQogICAgICAgICAgICAgICAgdmFyIHk9IDA7DQogICAgICAgICAgICAgICAgdmFyIHgxID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICAgICAgdmFyIHkxID0geCAqIG1hQXJyWzFdICsgeSAqIG1hQXJyWzNdICsgbWFBcnJbNV07DQogICAgICAgICAgICAgICAgeCA9IHBhcnNlRmxvYXQoY3NbMF0pKzE2Ow0KICAgICAgICAgICAgICAgIHk9IC0xNjsNCiAgICAgICAgICAgICAgICB2YXIgeDIgPSB4ICogbWFBcnJbMF0gKyB5ICogbWFBcnJbMl0gKyBtYUFycls0XTsNCiAgICAgICAgICAgICAgICB2YXIgeTIgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgICAgICB2YXIgZnggPSB4MTx4Mj94MS50b3N1aXRzdmcoKTogeDIudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICAgICAgdmFyIGZ5ID0geTE+eTI/eTEudG9zdWl0c3ZnKCk6IHkyLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgICAgIHZhciB0cnN0ciA9ICAndHJhbnNsYXRlKCcrZngrJywnK2Z5KycpJzsNCiAgICAgICAgICAgICAgICBwb3B1cFIuc2V0QXR0cmlidXRlKCdoZWlnaHQnLG9mZnkudG9TdHJpbmcoKSk7DQogICAgICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCcxNicpOw0KICAgICAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ3knLCgtb2ZmeSkudG9TdHJpbmcoKSk7DQogICAgICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgnZmlsbCcsJ3RyYW5zcGFyZW50Jyk7DQogICAgICAgICAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQocG9wdXBSKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBvdXQuc2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nLHRyc3RyKTsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N2Zy1jb250YWluZXIgPiBzdmcnKS5hcHBlbmRDaGlsZChvdXQpOw0KICAgICAgICBub3Rlc1tpXS5vbm1vdXNlb3Zlcj1mdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbm90ZWlkPXRoaXMucGFyZW50Tm9kZS5pZDsNCiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcigncmVjdCcpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDpub3RlaWQ9JyIrbm90ZWlkKyInXVtub3RlXSIpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgICAgfTsNCiAgICAgICAgbm90ZXNbaV0ub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbm90ZWlkPXRoaXMucGFyZW50Tm9kZS5pZDsNCi8vICAgICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDpub3RlaWQ9JyIrbm90ZWlkKyInXVtub3RlXSIpLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgICAgICB9DQogICAgfQ0KfWVsc2V7DQogICAgY29uc29sZS5sb2coJ+aKseatie+8jElF5rWP6KeI5Zmo5LiN5pSv5oyBbm90Zeino+aekO+8jOivt+S9v+eUqOWFtuS7luWGheaguOa1j+iniOWZqOOAguiwouiwou+8gScpDQp9DQovLy0tbm90ZQ0KLy9oeXBlcmxpbmstLQ0KdmFyIGxpbmtzPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2c+Z1tlZFxcOmh5cGVybGlua10nKTsNCmZ1bmN0aW9uIGdldG1heGxlbihhcnIsYnJyKSB7DQogICAgdmFyIGw9MDsNCiAgICB2YXIgbGw9MDsNCiAgICBmb3IodmFyIGo9MDtqPGFyci5sZW5ndGg7aisrKXsNCiAgICAgICAgdmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ3RleHQnKTsNCiAgICAgICAgaWYoIWlzTmFOKGxpbmthcnJbal0pKXsNCiAgICAgICAgICAgIGUudGV4dENvbnRlbnQ9J1BhZ2UtJythcnJbal07DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgZS50ZXh0Q29udGVudD1hcnJbal07DQogICAgICAgIH0NCiAgICAgICAgZS5zdHlsZS5mb250U2l6ZT0nMTJweCc7DQogICAgICAgIGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N2ZycpWzBdLmFwcGVuZENoaWxkKGUpOw0KICAgICAgICB2YXIgZXc9ZS5nZXRCQm94KCkud2lkdGg7DQogICAgICAgIGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N2ZycpWzBdLnJlbW92ZUNoaWxkKGUpOw0KICAgICAgICB2YXIgaD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywndGV4dCcpOw0KICAgICAgICBoLnRleHRDb250ZW50PWJycltqXTsNCiAgICAgICAgaC5zdHlsZS5mb250U2l6ZT0nMTJweCc7DQogICAgICAgIGguc3R5bGUuZm9udFdlaWdodD0nYm9sZCc7DQogICAgICAgIGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N2ZycpWzBdLmFwcGVuZENoaWxkKGgpOw0KICAgICAgICB2YXIgaHc9aC5nZXRCQm94KCkud2lkdGg7DQogICAgICAgIGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N2ZycpWzBdLnJlbW92ZUNoaWxkKGgpOw0KICAgICAgICBsPWV3Pmh3P2V3Omh3Ow0KICAgICAgICBsbD1sPmxsP2w6bGw7DQogICAgfQ0KICAgIHJldHVybiBsbDsNCn0NCmZvcih2YXIgaT0wO2k8bGlua3MubGVuZ3RoO2krKyl7DQogICAgdmFyIHBvcHVwPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdnJyk7DQogICAgdmFyIHBvcHVwUj0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ3JlY3QnKTsNCiAgICB2YXIgaG92ZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ3JlY3QnKTsNCiAgICB2YXIgZGVzY2Fycj1bXTsNCiAgICB2YXIgbGlua2Fycj1bXTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCcjY2RjZGZmJyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCd4JywnMCcpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgneScsJzAnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsJzE2Jyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCd3aWR0aCcsJzE2Jyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCdmaWxsLW9wYWNpdHknLCcwLjYnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsbGlua3NbaV0ucXVlcnlTZWxlY3RvcigndXNlJykuZ2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nKSk7DQogICAgaG92ZXIuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgbGlua3NbaV0uYXBwZW5kQ2hpbGQoaG92ZXIpOw0KICAgIC8vIGNvbnNvbGUubG9nKGxpbmtzW2ldLmdldEF0dHJpYnV0ZSgnZWQ6aHlwZXJsaW5rJykpOw0KICAgIHZhciBhPUpTT04ucGFyc2UobGlua3NbaV0uZ2V0QXR0cmlidXRlKCdlZDpoeXBlcmxpbmsnKSk7DQogICAgdmFyIGNzPWxpbmtzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3VzZScpLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJykubWF0Y2goL1woKFxTKnxcUypcc1xTKilcKS8pWzFdLnNwbGl0KC8gfCwvKTsNCiAgICB2YXIgcHM9bGlua3NbaV0ucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScpOw0KICAgIGlmKHBzLnN1YnN0cigwLDIpID09ICd0cicpew0KICAgICAgICB2YXIgcHBzID0gcHMubWF0Y2goL1woKFxTKnxcUypcc1xTKilcKS8pWzFdLnNwbGl0KC8gfCwvKTsNCiAgICAgICAgdmFyIHg9cGFyc2VGbG9hdChjc1swXSkrcGFyc2VGbG9hdChwcHNbMF0pOw0KICAgICAgICB2YXIgeT1wYXJzZUZsb2F0KHBwc1sxXSk7DQogICAgICAgIHg9eC50b3N1aXRzdmcoKTsNCiAgICAgICAgeT15LnRvc3VpdHN2ZygpOw0KICAgICAgICB2YXIgdHJzdHIgPSAndHJhbnNsYXRlKCcreCsnLCcreSsnKSc7DQogICAgfWVsc2UgaWYocHMuc3Vic3RyKDAsMikgPT0gJ21hJyl7DQogICAgICAgIHZhciBwcHMgPSBwcy5tYXRjaCgvKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVwpJC8pOw0KICAgICAgICB2YXIgbWFBcnIgPSBbcGFyc2VGbG9hdChwcHNbMV0pLHBhcnNlRmxvYXQocHBzWzNdKSxwYXJzZUZsb2F0KHBwc1s1XSkscGFyc2VGbG9hdChwcHNbN10pLHBhcnNlRmxvYXQocHBzWzldKSxwYXJzZUZsb2F0KHBwc1sxMV0pXTsNCiAgICAgICAgaWYobWFBcnJbMV0gPT0gMCl7DQogICAgICAgICAgICB2YXIgeCA9IHBhcnNlRmxvYXQoY3NbMF0pOw0KICAgICAgICAgICAgdmFyIHk9IDA7DQogICAgICAgICAgICB2YXIgeDEgPSB4ICogbWFBcnJbMF0gKyB5ICogbWFBcnJbMl0gKyBtYUFycls0XTsNCiAgICAgICAgICAgIHZhciB5MSA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgeDE9eDEudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICB5MT15MS50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciB0cnN0ciA9ICAndHJhbnNsYXRlKCcreDErJywnK3kxKycpJzsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICB2YXIgeCA9IHBhcnNlRmxvYXQoY3NbMF0pKzE2Ow0KICAgICAgICAgICAgdmFyIHk9IDA7DQogICAgICAgICAgICB2YXIgeDEgPSB4ICogbWFBcnJbMF0gKyB5ICogbWFBcnJbMl0gKyBtYUFycls0XTsNCiAgICAgICAgICAgIHZhciB5MSA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgeCA9IHBhcnNlRmxvYXQoY3NbMF0pKzE2Ow0KICAgICAgICAgICAgeT0gLTE2Ow0KICAgICAgICAgICAgdmFyIHgyID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTIgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHZhciBmeCA9IHgxPHgyP3gxLnRvc3VpdHN2ZygpOiB4Mi50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciBmeSA9IHkxPnkyP3kxLnRvc3VpdHN2ZygpOiB5Mi50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciB0cnN0ciA9ICAndHJhbnNsYXRlKCcrZngrJywnK2Z5KycpJzsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsb2ZmeS50b1N0cmluZygpKTsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywnMTYnKTsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ3knLCgtb2ZmeSkudG9TdHJpbmcoKSk7DQogICAgICAgICAgICBwb3B1cFIuc2V0QXR0cmlidXRlKCdmaWxsJywndHJhbnNwYXJlbnQnKTsNCiAgICAgICAgICAgIHBvcHVwLmFwcGVuZENoaWxkKHBvcHVwUik7DQogICAgICAgIH0NCiAgICB9DQogICAgdmFyIGFsPWEubGVuZ3RoOw0KICAgIGZvcih2YXIgaj0wO2o8YWw7aisrKXsNCiAgICAgICAgbGlua2Fyci5wdXNoKGFbal0ubGluayk7DQogICAgICAgIGRlc2NhcnIucHVzaChhW2pdLmRlc2MpOw0KICAgIH0NCiAgICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsdHJzdHIpOw0KICAgIHZhciBtYXg9Z2V0bWF4bGVuKGxpbmthcnIsZGVzY2Fycik7DQogICAgZm9yKHZhciBrPTA7azxhbDtrKyspew0KICAgICAgICB2YXIgYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywnYScpOw0KICAgICAgICB2YXIgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywncmVjdCcpOw0KICAgICAgICB2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywndGV4dCcpOw0KICAgICAgICB2YXIgZj1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywndGV4dCcpOw0KICAgICAgICBpZihpc05hTihsaW5rYXJyW2tdKSl7DQogICAgICAgICAgICBjLnNldEF0dHJpYnV0ZSgnaHJlZicsbGlua2FycltrXSk7DQogICAgICAgICAgICBjLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywnX2JsYW5rJyk7DQogICAgICAgICAgICBlLnRleHRDb250ZW50PWxpbmthcnJba107DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgZS50ZXh0Q29udGVudD0nUGFnZS0nK2xpbmthcnJba107DQogICAgICAgICAgICBjLnNldEF0dHJpYnV0ZSgnaHJlZicsJyMnK2xpbmthcnJba10pOw0KICAgICAgICB9DQogICAgICAgIGQuc2V0QXR0cmlidXRlKCd3aWR0aCcsbWF4KzEwKTsNCiAgICAgICAgZC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsJzMzJyk7DQogICAgICAgIGQuc2V0QXR0cmlidXRlKCdzdHJva2UnLCcjOTk5OTk5Jyk7DQogICAgICAgIGQuc2V0QXR0cmlidXRlKCdmaWxsJywnd2hpdGUnKTsNCiAgICAgICAgZC5zZXRBdHRyaWJ1dGUoJ3knLDMzKmspOw0KICAgICAgICBmLnRleHRDb250ZW50PWRlc2NhcnJba107DQogICAgICAgIGYuc3R5bGUuZm9udFNpemU9JzEycHgnOw0KICAgICAgICBmLnN0eWxlLmZvbnRXZWlnaHQ9J2JvbGQnOw0KICAgICAgICBmLnNldEF0dHJpYnV0ZSgneCcsNSk7DQogICAgICAgIGYuc2V0QXR0cmlidXRlKCd5JywzMyprKzEyKTsNCiAgICAgICAgZS5zdHlsZS5mb250U2l6ZT0nMTJweCc7DQogICAgICAgIGUuc2V0QXR0cmlidXRlKCd5JywzMyprKzI4KTsNCiAgICAgICAgZS5zZXRBdHRyaWJ1dGUoJ3gnLDUpOw0KICAgICAgICBjLmFwcGVuZENoaWxkKGQpOw0KICAgICAgICBjLmFwcGVuZENoaWxkKGYpOw0KICAgICAgICBjLmFwcGVuZENoaWxkKGUpOw0KICAgICAgICBjLm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcigncmVjdCcpLnN0eWxlLmZpbGw9JyNlMWUxZmYnDQogICAgICAgIH07DQogICAgICAgIGMub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5maWxsPSd3aGl0ZScNCiAgICAgICAgfTsNCiAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQoYyk7DQogICAgfQ0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgnaHlwZXJsaW5rJywnJyk7DQogICAgcG9wdXAuc2V0QXR0cmlidXRlKCdlZDpsaW5raWQnLGxpbmtzW2ldLnBhcmVudE5vZGUuaWQpOw0KICAgIHBvcHVwLm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgfTsNCiAgICBwb3B1cC5vbmNsaWNrPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICB9Ow0KICAgIHBvcHVwLm9ubW91c2VvdXQ9ZnVuY3Rpb24gKCkgew0KICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIH07DQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N2Zy1jb250YWluZXIgPiBzdmcnKS5hcHBlbmRDaGlsZChwb3B1cCk7DQogICAgbGlua3NbaV0ub25tb3VzZW92ZXI9ZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgbGlua2lkPXRoaXMucGFyZW50Tm9kZS5pZDsNCiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCdyZWN0Jykuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6bGlua2lkPSciK2xpbmtpZCsiJ11baHlwZXJsaW5rXSIpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICB9DQogICAgbGlua3NbaV0ub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBsaW5raWQ9dGhpcy5wYXJlbnROb2RlLmlkOw0KICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOmxpbmtpZD0nIitsaW5raWQrIiddW2h5cGVybGlua10iKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICB9DQp9DQovLy0taHlwZXJsaW5rDQovL2luaXRpYWxpemUtLQ0KdmFyIHNoYXBlPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2dbZWRcXDp0b2d0b3BpY2lkXScpOw0KdmFyIG1JZD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdnW2VkXFw6dG9waWN0eXBlXScpOw0KdmFyIGRhdGFUcmVlPXt9Ow0KdmFyIGV4dHJhUmVsYT17fTsNCnZhciBjaGVja0lEPScnOw0KZm9yKHZhciBpPTA7aTxtSWQubGVuZ3RoO2krKyl7DQogICAgdmFyIHR5cGU9bUlkW2ldLmdldEF0dHJpYnV0ZSgnZWQ6dG9waWN0eXBlJyk7DQogICAgdmFyIHNpZD1tSWRbaV0uaWQ7DQogICAgaWYodHlwZSE9PSdjYWxsb3V0Jyl7DQogICAgICAgIGluaXQoc2lkLGRhdGFUcmVlKQ0KICAgIH0NCn0NCmZ1bmN0aW9uIGluaXQoaWQsIG9iaikgew0KICAgIHZhciBjaGlsZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJnW2VkXFw6cGFyZW50aWQ9JyIgKyBpZCArICInXTpub3QoW2VkXFw6dG9waWN0eXBlXSkiKTsNCiAgICB2YXIgY2FsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJnW2VkXFw6cGFyZW50aWQ9JyIgKyBpZCArICInXVtlZFxcOnRvcGljdHlwZV0iKTsNCiAgICB2YXIgc3VtbWFyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInBhdGhbZWRcXDpwYXJlbnRpZCo9JyIgKyBpZCArICInXVtlZFxcOnR5cGU9J3N1bW1hcnknXSIpOw0KICAgIHZhciBib3VuZGFyeT0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgicGF0aFtlZFxcOnBhcmVudGlkKj0nIiArIGlkICsgIiddW2VkXFw6dHlwZT0nYm91bmRhcnknXSIpOw0KICAgIHZhciByZWxhZnJvbT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJnW2VkXFw6ZnJvbWlkKj0nIiArIGlkICsgIiddW2VkXFw6dHlwZT0ncmVsYXRpb24nXSIpOw0KICAgIHZhciByZWxhdG89ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiZ1tlZFxcOnRvaWQqPSciICsgaWQgKyAiJ11bZWRcXDp0eXBlPSdyZWxhdGlvbiddIik7DQogICAgb2JqWyJtIiArIGlkXSA9IHt9Ow0KICAgIHZhciB0eXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmdldEF0dHJpYnV0ZSgnZWQ6dG9waWN0eXBlJyk7DQogICAgdmFyIGl3PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5nZXRBdHRyaWJ1dGUoJ2VkOndpZHRoJyk7DQogICAgdmFyIGloPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5nZXRBdHRyaWJ1dGUoJ2VkOmhlaWdodCcpOw0KICAgIGlmICh0eXBlKSB7DQogICAgICAgIG9ialsibSIgKyBpZF0udHlwZSA9IHR5cGU7DQogICAgfQ0KICAgIGlmKGl3JiZpaCl7DQogICAgICAgIG9ialsibSIgKyBpZF0ud2lkdGggPWl3Ow0KICAgICAgICBvYmpbIm0iICsgaWRdLmhlaWdodCA9aWg7DQogICAgfQ0KICAgIGlmIChyZWxhZnJvbS5sZW5ndGggIT09IDApIHsNCiAgICAgICAgb2JqWyJtIiArIGlkXS5yZWxhZnJvbSA9IHt9Ow0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbGFmcm9tLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgaW5kZXhpZCA9IHJlbGFmcm9tW2ldLmlkOw0KICAgICAgICAgICAgdmFyIHRvaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpbmRleGlkKS5nZXRBdHRyaWJ1dGUoJ2VkOnRvaWQnKTsNCiAgICAgICAgICAgIGlmIChleHRyYVJlbGFbaW5kZXhpZF0gPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGV4dHJhUmVsYVtpbmRleGlkXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZGV4aWQsDQogICAgICAgICAgICAgICAgICAgIGZyb21pZDogaWQsDQogICAgICAgICAgICAgICAgICAgIHRvaWQ6IHRvaWQsDQogICAgICAgICAgICAgICAgICAgIGlzQzogZmFsc2UNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb2JqWyJtIiArIGlkXS5yZWxhZnJvbVtpbmRleGlkXT17fTsNCiAgICAgICAgICAgIG9ialsibSIgKyBpZF0ucmVsYWZyb20uZGlzcGxheT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnPydibG9jayc6J25vbmUnOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChyZWxhdG8ubGVuZ3RoICE9PSAwKSB7DQogICAgICAgIG9ialsibSIgKyBpZF0ucmVsYXRvID0ge307DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVsYXRvLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgaW5kZXhpZD1yZWxhdG9baV0uaWQ7DQogICAgICAgICAgICB2YXIgZnJvbWlkPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGluZGV4aWQpLmdldEF0dHJpYnV0ZSgnZWQ6ZnJvbWlkJyk7DQogICAgICAgICAgICBpZihleHRyYVJlbGFbaW5kZXhpZF0gPT09IHVuZGVmaW5lZCl7DQogICAgICAgICAgICAgICAgZXh0cmFSZWxhW2luZGV4aWRdPXsNCiAgICAgICAgICAgICAgICAgICAgaWQ6aW5kZXhpZCwNCiAgICAgICAgICAgICAgICAgICAgZnJvbWlkOmZyb21pZCwNCiAgICAgICAgICAgICAgICAgICAgdG9pZDppZCwNCiAgICAgICAgICAgICAgICAgICAgaXNDOmZhbHNlDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9ialsibSIgKyBpZF0ucmVsYXRvW2luZGV4aWRdPXt9Ow0KICAgICAgICAgICAgb2JqWyJtIiArIGlkXS5yZWxhdG8uZGlzcGxheT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnPydibG9jayc6J25vbmUnOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChjaGlsZHMubGVuZ3RoICE9PSAwKSB7DQogICAgICAgIG9ialsibSIgKyBpZF0uY2hpbGQgPSB7fTsNCiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDp0b2d0b3BpY2lkPSciICsgaWQgKyAiJ10iKSkgew0KICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOnRvZ3RvcGljaWQ9JyIgKyBpZCArICInXSIpLmNoaWxkTm9kZXNbMF0uZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJykpOw0KICAgICAgICAgICAgdmFyIHRvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDp0b2d0b3BpY2lkPSciICsgaWQgKyAiJ10iKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndXNlJylbMF0uZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJykuc2xpY2UoMSk7DQogICAgICAgICAgICBvYmpbIm0iICsgaWRdLnRvZ3R5cGUgPSB0b2c7DQogICAgICAgIH0NCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBjaWQgPSBjaGlsZHNbaV0uaWQ7DQogICAgICAgICAgICBpbml0KGNpZCwgb2JqWyJtIiArIGlkXS5jaGlsZCk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGNhbGxzLmxlbmd0aCAhPT0gMCkgew0KICAgICAgICBvYmpbIm0iICsgaWRdLmNhbGwgPSB7fTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxscy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgdmFyIGNpZCA9IGNhbGxzW2ldLmlkOw0KICAgICAgICAgICAgaW5pdChjaWQsIG9ialsibSIgKyBpZF0uY2FsbCk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGJvdW5kYXJ5Lmxlbmd0aCAhPT0gMCkgew0KICAgICAgICBvYmpbIm0iICsgaWRdLmJvdW5kYXJ5ID0ge307DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm91bmRhcnkubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBjaWQgPWJvdW5kYXJ5W2ldLmlkOw0KICAgICAgICAgICAgaW5pdChjaWQsIG9ialsibSIgKyBpZF0uYm91bmRhcnkpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChzdW1tYXJ5Lmxlbmd0aCAhPT0gMCkgew0KICAgICAgICBvYmpbIm0iICsgaWRdLnN1bW1hcnkgPSB7fTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdW1tYXJ5Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgY2lkID0gc3VtbWFyeVtpXS5pZDsNCiAgICAgICAgICAgIGluaXQoY2lkLCBvYmpbIm0iICsgaWRdLnN1bW1hcnkpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KLy8tLWluaXRpYWxpemUNCi8vdG9nZ2xlZGlzcGxheS0tDQp2YXIgY2hhaW5BcnI9W107DQpmdW5jdGlvbiBnZXRjaGFpbihpZCl7DQogICAgY2hhaW5BcnIudW5zaGlmdCgnbScraWQpOw0KICAgIHZhciBwYXJlbnQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmdldEF0dHJpYnV0ZSgnZWQ6cGFyZW50aWQnKTsNCiAgICBpZighcGFyZW50KXsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBnZXRjaGFpbihwYXJlbnQpOw0KfQ0KZnVuY3Rpb24gZ2V0b2JqKGlkKSB7DQogICAgY2hhaW5BcnI9W107DQogICAgZ2V0Y2hhaW4oaWQpOw0KICAgIHZhciBtYWluPWNoYWluQXJyWzBdOw0KICAgIGlmKGNoYWluQXJyLmxlbmd0aD4xKXsNCiAgICAgICAgdmFyIG9iaj1kYXRhVHJlZVttYWluXTsNCiAgICAgICAgLy8gY29uc29sZS5sb2coY2hhaW5BcnIpOw0KICAgICAgICBmb3IodmFyIGk9MTtpPGNoYWluQXJyLmxlbmd0aDtpKyspIHsNCiAgICAgICAgICAgIHZhciBhID0gY2hhaW5BcnJbaV07DQogICAgICAgICAgICBmb3IodmFyIGo9MDtqPE9iamVjdC5rZXlzKG9iaikubGVuZ3RoO2orKyl7DQogICAgICAgICAgICAgICAgdmFyIGNvYmo9IG9ialtPYmplY3Qua2V5cyhvYmopW2pdXVthXTsNCiAgICAgICAgICAgICAgICBpZihjb2JqKXsNCiAgICAgICAgICAgICAgICAgICAgb2JqPWNvYmo7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBvYmoNCiAgICB9ZWxzZXsNCiAgICAgICAgdmFyIG9iaj1kYXRhVHJlZVttYWluXTsNCiAgICAgICAgcmV0dXJuIG9iag0KICAgIH0NCg0KfQ0KZm9yKHZhciBpPTA7aTxzaGFwZS5sZW5ndGg7aSsrKXsNCiAgICBzaGFwZVtpXS5vbmNsaWNrPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIGlkPU51bWJlcih0aGlzLmdldEF0dHJpYnV0ZSgnZWQ6dG9ndG9waWNpZCcpKTsNCiAgICAgICAgdmFyIG9iaj1nZXRvYmooaWQpOw0KDQogICAgICAgIHZhciB0eXBlPW9iai50b2d0eXBlPT09J21pbnVzJz8ncGx1cyc6J21pbnVzJzsNCiAgICAgICAgdmFyIGRpc3BsYXk9b2JqLnRvZ3R5cGU9PT0nbWludXMnPydub25lJzonYmxvY2snOw0KICAgICAgICB0aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd1c2UnKVswXS5zZXRBdHRyaWJ1dGUoJ3hsaW5rOmhyZWYnLCcjJyt0eXBlKTsNCiAgICAgICAgb2JqLnRvZ3R5cGU9dHlwZTsNCiAgICAgICAgY2hlY2tJRD1vYmo7DQoNCiAgICAgICAgdXRkKG9iaixpZCxkaXNwbGF5KTsNCiAgICAgICAgZXh0cmFSZWxhRmluKCk7DQogICAgfQ0KfQ0KZnVuY3Rpb24gdXRkKG9iaixpZCxzaG93LG9jKSB7DQoNCiAgICB2YXIgcHNob3c9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnN0eWxlLmRpc3BsYXkhPT0gJ25vbmUnPydibG9jayc6J25vbmUnOw0KICAgIGlmIChvYmoucmVsYWZyb20pew0KICAgICAgICBpZihvYmoucmVsYWZyb20uZGlzcGxheSE9PSBwc2hvdyl7DQogICAgICAgICAgICB2YXIgcmVsYWZyb21zPU9iamVjdC5rZXlzKG9iai5yZWxhZnJvbSk7DQogICAgICAgICAgICByZWxhZnJvbXMuc3BsaWNlKHJlbGFmcm9tcy5pbmRleE9mKCdkaXNwbGF5JyksMSk7DQogICAgICAgICAgICBmb3IodmFyIGs9MDtrPHJlbGFmcm9tcy5sZW5ndGg7aysrKXsNCiAgICAgICAgICAgICAgICB2YXIgZD1yZWxhZnJvbXNba107DQogICAgICAgICAgICAgICAgZXh0cmFSZWxhW2RdLmlzQz10cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb2JqLnJlbGFmcm9tLmRpc3BsYXkgPSBwc2hvdzsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAob2JqLnJlbGF0byl7DQogICAgICAgIGlmKG9iai5yZWxhdG8uZGlzcGxheSE9PSBwc2hvdyl7DQogICAgICAgICAgICB2YXIgcmVsYXRvcz1PYmplY3Qua2V5cyhvYmoucmVsYXRvKTsNCiAgICAgICAgICAgIHJlbGF0b3Muc3BsaWNlKHJlbGF0b3MuaW5kZXhPZignZGlzcGxheScpLDEpOw0KICAgICAgICAgICAgZm9yKHZhciBrPTA7azxyZWxhdG9zLmxlbmd0aDtrKyspew0KICAgICAgICAgICAgICAgIHZhciBkPXJlbGF0b3Nba107DQogICAgICAgICAgICAgICAgZXh0cmFSZWxhW2RdLmlzQz10cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb2JqLnJlbGF0by5kaXNwbGF5ID0gcHNob3c7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYob2JqLmNhbGwpew0KICAgICAgICB2YXIgY2FsbHM9T2JqZWN0LmtleXMob2JqLmNhbGwpOw0KICAgICAgICBpZihjaGVja0lEIT09b2JqKXsNCiAgICAgICAgICAgIGZvcih2YXIgaT0wO2kgPCBjYWxscy5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICB2YXIgYT1jYWxsc1tpXS5zbGljZSgxKTsNCiAgICAgICAgICAgICAgICB2YXIgYj1vYmouY2FsbFtjYWxsc1tpXV07DQogICAgICAgICAgICAgICAgdmFyIGM9Yi50b2d0eXBlOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEpLnN0eWxlLmRpc3BsYXk9c2hvdzsNCiAgICAgICAgICAgICAgICBpZiAoYi5yZWxhZnJvbSYmIWMpew0KICAgICAgICAgICAgICAgICAgICBpZihiLnJlbGFmcm9tLmRpc3BsYXkhPT0gc2hvdyl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYWZyb21zPU9iamVjdC5rZXlzKGIucmVsYWZyb20pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVsYWZyb21zLnNwbGljZShyZWxhZnJvbXMuaW5kZXhPZignZGlzcGxheScpLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBrPTA7azxyZWxhZnJvbXMubGVuZ3RoO2srKyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQ9cmVsYWZyb21zW2tdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhUmVsYVtkXS5pc0M9dHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGIucmVsYWZyb20uZGlzcGxheSA9IHNob3c7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGIucmVsYXRvJiYhYyl7DQogICAgICAgICAgICAgICAgICAgIGlmKGIucmVsYXRvLmRpc3BsYXkhPT0gc2hvdyl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYXRvcz1PYmplY3Qua2V5cyhiLnJlbGF0byk7DQogICAgICAgICAgICAgICAgICAgICAgICByZWxhdG9zLnNwbGljZShyZWxhdG9zLmluZGV4T2YoJ2Rpc3BsYXknKSwxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaz0wO2s8cmVsYXRvcy5sZW5ndGg7aysrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZD1yZWxhdG9zW2tdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhUmVsYVtkXS5pc0M9dHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGIucmVsYXRvLmRpc3BsYXkgPSBzaG93Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKGMpew0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6dG9ndG9waWNpZD0nIithKyInXSIpLnN0eWxlLmRpc3BsYXk9c2hvdzsNCiAgICAgICAgICAgICAgICAgICAgaWYoYz09PSdtaW51cycpew0KICAgICAgICAgICAgICAgICAgICAgICAgdXRkKGIsYSxzaG93KQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICgoYi5jYWxsfHxiLmJvdW5kYXJ5fHxiLnN1bW1hcnkpJiZjPT09J3BsdXMnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3csdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihiLmNhbGwmJiFjKSB7DQogICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdyx0cnVlKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoYi5zdW1tYXJ5JiYhYykgew0KICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChiLmJvdW5kYXJ5JiYhYykgew0KICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYob2JqLnN1bW1hcnkpew0KICAgICAgICB2YXIgc3VtbWFyeXM9T2JqZWN0LmtleXMob2JqLnN1bW1hcnkpOw0KICAgICAgICBpZigoY2hlY2tJRCE9PW9iaiYmKG9iai50b2d0eXBlPT09J21pbnVzJ3x8IW9iai50b2d0eXBlKSl8fGNoZWNrSUQ9PT1vYmopew0KICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxzdW1tYXJ5cy5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICB2YXIgYT1zdW1tYXJ5c1tpXS5zbGljZSgxKTsNCiAgICAgICAgICAgICAgICB2YXIgYj1vYmouc3VtbWFyeVtzdW1tYXJ5c1tpXV07DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYSk7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSkuc3R5bGUuZGlzcGxheT1zaG93Ow0KLy8gICAgICAgICAgICAgICAgaWYoYyl7DQovLyAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOnRvZ3RvcGljaWQ9JyIrYSsiJ10iKS5zdHlsZS5kaXNwbGF5PXNob3c7DQovLyAgICAgICAgICAgICAgICAgICAgaWYoYz09PSdtaW51cycpew0KLy8gICAgICAgICAgICAgICAgICAgICAgICB1dGQoYixzaG93KQ0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgICAgICBpZiAoYi5jYWxsJiZjPT09J3BsdXMnKSB7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIHV0ZChiLHNob3csdHJ1ZSkNCi8vICAgICAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgICAgICBpZihiLmNhbGwmJiFjKSB7DQovLyAgICAgICAgICAgICAgICAgICAgdXRkKGIsc2hvdyx0cnVlKQ0KLy8gICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKE9iamVjdC5rZXlzKGIpLmxlbmd0aCE9PTApew0KICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGlmKG9iai5ib3VuZGFyeSl7DQogICAgICAgIHZhciBib3VuZGFyeXM9T2JqZWN0LmtleXMob2JqLmJvdW5kYXJ5KTsNCiAgICAgICAgaWYoY2hlY2tJRCE9PW9iail7DQogICAgICAgICAgICBmb3IodmFyIGk9MDtpPGJvdW5kYXJ5cy5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICB2YXIgYT1ib3VuZGFyeXNbaV0uc2xpY2UoMSk7DQogICAgICAgICAgICAgICAgdmFyIGI9b2JqLmJvdW5kYXJ5W2JvdW5kYXJ5c1tpXV07DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYSk7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSkuc3R5bGUuZGlzcGxheT1zaG93Ow0KLy8gICAgICAgICAgICAgICAgaWYoYyl7DQovLyAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOnRvZ3RvcGljaWQ9JyIrYSsiJ10iKS5zdHlsZS5kaXNwbGF5PXNob3c7DQovLyAgICAgICAgICAgICAgICAgICAgaWYoYz09PSdtaW51cycpew0KLy8gICAgICAgICAgICAgICAgICAgICAgICB1dGQoYixzaG93KQ0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgICAgICBpZiAoYi5jYWxsJiZjPT09J3BsdXMnKSB7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIHV0ZChiLHNob3csdHJ1ZSkNCi8vICAgICAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgICAgICB9DQovLyAgICAgICAgICAgICAgICBpZihiLmNhbGwmJiFjKSB7DQovLyAgICAgICAgICAgICAgICAgICAgdXRkKGIsc2hvdyx0cnVlKQ0KLy8gICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKE9iamVjdC5rZXlzKGIpLmxlbmd0aCE9PTApew0KICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGlmKCFvYyYmb2JqLmNoaWxkKSB7DQogICAgICAgIHZhciBjaGlsZHMgPSBPYmplY3Qua2V5cyhvYmouY2hpbGQpOw0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgdmFyIGEgPSBjaGlsZHNbaV0uc2xpY2UoMSk7DQogICAgICAgICAgICB2YXIgYiA9IG9iai5jaGlsZFtjaGlsZHNbaV1dOw0KICAgICAgICAgICAgdmFyIGMgPSBiLnRvZ3R5cGU7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhKS5zdHlsZS5kaXNwbGF5ID0gc2hvdzsNCgkJCXZhciB0U1BhdGggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJwYXRoW2VkXFw6dG9zdXBlcmlkPSciK2ErIiddIik7DQogICAgICAgICAgICBpZih0U1BhdGgpew0KICAgICAgICAgICAgICAgIHRTUGF0aC5zdHlsZS5kaXNwbGF5ID0gc2hvdzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChiLnJlbGFmcm9tJiYhYyl7DQogICAgICAgICAgICAgICAgaWYoYi5yZWxhZnJvbS5kaXNwbGF5IT09IHNob3cpew0KICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYWZyb21zPU9iamVjdC5rZXlzKGIucmVsYWZyb20pOw0KICAgICAgICAgICAgICAgICAgICByZWxhZnJvbXMuc3BsaWNlKHJlbGFmcm9tcy5pbmRleE9mKCdkaXNwbGF5JyksMSk7DQogICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaz0wO2s8cmVsYWZyb21zLmxlbmd0aDtrKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQ9cmVsYWZyb21zW2tdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFSZWxhW2RdLmlzQz10cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGIucmVsYWZyb20uZGlzcGxheSA9IHNob3c7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGIucmVsYXRvJiYhYyl7DQogICAgICAgICAgICAgICAgaWYoYi5yZWxhdG8uZGlzcGxheSE9PSBzaG93KXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0b3M9T2JqZWN0LmtleXMoYi5yZWxhdG8pOw0KICAgICAgICAgICAgICAgICAgICByZWxhdG9zLnNwbGljZShyZWxhdG9zLmluZGV4T2YoJ2Rpc3BsYXknKSwxKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBrPTA7azxyZWxhdG9zLmxlbmd0aDtrKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQ9cmVsYXRvc1trXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhUmVsYVtkXS5pc0M9dHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBiLnJlbGF0by5kaXNwbGF5ID0gc2hvdzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYykgew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDp0b2d0b3BpY2lkPSciICsgYSArICInXSIpLnN0eWxlLmRpc3BsYXkgPSBzaG93Ow0KICAgICAgICAgICAgICAgIGlmIChjID09PSAnbWludXMnKSB7DQogICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKChiLmNhbGx8fGIuYm91bmRhcnl8fGIuc3VtbWFyeSkmJmM9PT0ncGx1cycpIHsNCiAgICAgICAgICAgICAgICAgICAgdXRkKGIsYSxzaG93LHRydWUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGIuY2FsbCYmIWMpIHsNCiAgICAgICAgICAgICAgICB1dGQoYixhLHNob3csdHJ1ZSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChiLnN1bW1hcnkmJiFjKSB7DQogICAgICAgICAgICAgICAgdXRkKGIsYSxzaG93KQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGIuYm91bmRhcnkmJiFjKSB7DQogICAgICAgICAgICAgICAgdXRkKGIsYSxzaG93KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBleHRyYVJlbGFGaW4oKSB7DQogICAgdmFyIGV4dHJha2V5cz1PYmplY3Qua2V5cyhleHRyYVJlbGEpOw0KICAgIGZvcih2YXIgaT0wO2k8ZXh0cmFrZXlzLmxlbmd0aDtpKyspew0KICAgICAgICB2YXIgZXh0cmFPYmo9ZXh0cmFSZWxhW2V4dHJha2V5c1tpXV07DQogICAgICAgIGlmKGV4dHJhT2JqLmlzQyA9PT0gdHJ1ZSl7DQogICAgICAgICAgICB2YXIgZnNob3c9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXh0cmFPYmouZnJvbWlkKS5zdHlsZS5kaXNwbGF5ICE9PSdub25lJz8gdHJ1ZTogZmFsc2U7DQogICAgICAgICAgICB2YXIgdHNob3c9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXh0cmFPYmoudG9pZCkuc3R5bGUuZGlzcGxheSAhPT0nbm9uZSc/IHRydWU6IGZhbHNlOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXh0cmFPYmouaWQpLnN0eWxlLmRpc3BsYXk9ZnNob3cgJiYgdHNob3c/ICdibG9jayc6ICdub25lJzsNCiAgICAgICAgICAgIGV4dHJhUmVsYVtleHRyYWtleXNbaV1dLmlzQyA9IGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KfQ=='))]]></content>
  </entry>
  <entry>
    <title><![CDATA[云私塾项目框架简述]]></title>
    <url>%2Fposts%2F50043%2F</url>
    <content type="text"><![CDATA[云私塾一、背景1、专业课市场的典型特点非统考自命题专业课市场，因专业课产品供给的多样性，而需求具有极强的分散性，一直以来都没能形成规模化的运营模式： 专业课产品供给的多样性： 研招单位共计842所，合计约50000个硕士招生专业； 每个专业均对应不同的考试内容、需求不同的学长学姐； 独立的考试科目为29896个，每个考试科目对应其考试真题，每年均有变动； 用户需求的分散性： 每年200余万考生的需求分散在45061个专业中，无法精确获知每个用户的需求倾向以及付费意向，需要大量的供给端服务储备，才能快速满足考生的需求； 每个商品细分下后可以匹配到的用户数范围大概在1-100人之间（有的专业每年只招1个人，有的专业较大，会招生几十人），每个专业了理论上都存在市场需求，但需求旺盛的程度差异极大； 相同需求的用户极度分散，无法有效聚拢用户； 2、考研专业课的典型需求 选校选专业的指导（也可说是职业生涯规划的指导）； 自命题专业课考研真题； 专业课考试内容的辅导； 目标院校的招生政策等非透明信息（报录比、参考书、复试要求等）； 3、需求满足方案 需求 需求满足方案 选校选专业 选校选专业的课程或公开课； 考研真题 收集并搭建专业课真题库，构建能够不断完善的真题库系统； 考试内容辅导 按照教材开设标配课程；定制化1v1辅导； 院校招生政策等非公开信息 研究生答疑；研究生信息收集； 二、项目模型1. 角色描述 角色 角色定位 考生-需求方 国内所有对考研服务有需求的用户 平台 提供信息交换的场景，构建逻辑粘性；提供增值服务，通过“人”的介入，建立情感粘性，实现商业价值的变现； 研究生-服务供给方 统招第一志愿录取，有意愿为考生提供辅导等服务的学长学姐 2. 云私塾供应链关系图 根据供应链原理，给出整个平台的供应链关系图，包含角色路径、提供的内容、我们希望获知的用户信息、最终的需求满足。 整体的信息流转规则： 校际以“专业”为最小的单元形成用户和内容的流转（多个院校开设相同专业）； 校内以”科目“为最小单元形成用户和内容的流转（多个专业初试相同科目）； 公共课相关内容贯穿在整个业务路程中； ps：点击图片，可以大图查看。 院校库：按照研招网的“地区-院校-专业-科目”为基础，搭建院校数据库，同时实现真题库、研究生库等的数据联动，实现院校检索的同时，呈现更为丰富多元的信息，增加用户的浏览时长。 真题库：按照研招网数据结构，搭建全国高校自命题专业课的考研专业课真题检索系统。真题作为考研专业课的极刚性需求，易于规模化，达到一定规模后，可以成为流量入口，对所有考生具备吸引力。 研究生库：按照研招网数据结构（与真题、院校结构同步，便于管理后期系统内的内容流转），搭建全国高校专业课研究生库。研究生作为考研过来人，熟知本校考试要求，且手头均有相应的资料储备，可以为考生提供==资料、辅导、答疑解惑等服务==，可以增加用户在整个系统内的活跃和留存时长，创造更多的营销机会。 参考书库：2013年后，教育部明确规定，不允许各大高校指定参考书及考试范围；参考书作为备考的重要参考条件，可以根据参考书给出标准化的专业课视屏课程，同时，参考书可以作为校际、校内考试科目的关系纽带，实现课程内容的内部流转； 3. 项目的功能模型及实现场景从“考生-平台-研究生”三个角色的角度，构建的功能模型如下，此处简化平台角色的功能，平台作为功能环境的主导者，存在无限延展的可能。 功能的实现场景，根据业务模型的特点，选择微信服务号+小程序，拓展到网站，后期服务接入APP。 业务模型特点： 对学员来说： 信息检索是最初目的，需要让用户便于体验和接触到产品； 需求和供给的低匹配度，需要让提醒和访问更智能和便捷； 问答及课时确认的社交属性，需要稳定便捷的交互环境； 对于研究生来说： 收益的持续性及额度强依赖于需求，无法有效保证，需要给用户一个较低的操作成本，且平时无消息时最好能消失在用户的关注点内； 强交互的问答、课时确认等功能，需要一个稳定和便捷的交互环境； 基于以上的几个特点，微信服务号作为首选的功能实现场景： 微信作为现代青年的首选社交工具，覆盖人群广，使用频率高，不易被卸载，环境稳定； 服务号的关注和取关成本低，关注后如果还有期待，一般不会取关； 轻资讯重功能的定位，符合云私塾的业务要求； 开放的多种接口，便于进行用户管理和消息触达； 有消息时提醒，没消息时静默不打扰，且沉默在用户消息列表中，不易引起厌烦； 4. 目前产品中的核心业务4.1 研究生问答业务 问答业务的流程图 核心功能点：问答收入的提现到账 问答作为用户的高频需求，而对于研究生来说，因收益较低，可能存在一定的打扰。需要将收益实时化，可视化，才能通过小额收益刺激研究生回答问题的积极性。 4.2 真题检索下载业务 “学校”- “专业” ，真题的检索下载，将作为比问答更刚性的基础需求，形成流量的入口。 4.3 1v1辅导业务 1v1业务的简要流程图 核心功能：1v1的分课时确认和结算逻辑 1v1辅导过程中必然存在研究生的替换、中途退课等各类服务性问题，所以灵活的服务调配和进度监控系统，是减轻后期运营压力、清晰业务流程必须的。该系统不依赖于我们自己的直播系统进行，授课环境更自由多元。 1v1 服务的前期发展构想 1v1辅导前期，可以相对野蛮的发展，不考虑通过自有系统实现课程辅导。收费后，用户和研究生可以自由选择上课途径，我们负责监控课时结算。后期有精力后再实现通过自有直播平台的系统化授课和监控。这样不会因为系统而耽搁业务的实现。 第一阶段：服务流程的标准化（不限定内容），不限制上课途径，只做好课时监控，可随时上线课程类产品； 第二阶段：服务方式的标准化，例如通过我们自有的直播平台等进行上课，监控课程质量和内容；对于达到一定规模的科目，建立小班化； 第三阶段：服务内容的标准化，根据沉淀的辅导内容，逐步制作标准化辅导的教案、课件等； 第四阶段：全流程的精细化运营； 5. 产品发展阶段规划及目标 产品的最终定位：考研一站式服务平台 用户通过该平台，可以满足公共课、专业课等各类考研需求。 产品阶段 时间节点 主要工作 产品目的 研究生入驻系统 2018年10月 10月份，完成底层数据库的重构，搭建研究生入驻系统，保证研究生能按照标准数据库完成入驻。 3000名研究生的入驻储备；（完整入驻指：基本完善院校信息，且审核通过） 研究生问答系统 2018年11月-12月 实现“用户-研究生”的问答交互； 初步满足用户对学长检索的需求，逐步累积数据，具备平台雏形。同时收集用户数据，指导后期课程建设及突破方向。 真题库的搭建 2018年12月-2019年7月 尽量在2018年12月25日前按照标准数据库格式，搭建真题回收系统，面向全网开展真题的回收审核，为3月份的宣传储备真题资源； 搭建2-3万份的真题储备，构建全网最全的真题检索系统，形成流量噱头。 平台服务信息结构的搭建 2019年1月-3月 新版院校库检索逻辑的构建。 融合院校搜索及研究生检索，实现院校库数据与问答等数据的互通。构建资讯、服务一站式服务体系。 1v1的课时确认系统 2019年3月-4月 根据公司合规部门的要求，构建适用于考研1v1辅导的业务流程。 完成1v1课程交付系统的开发，可以实现用户-研究生的服务交付及监控、酬劳支付和对账。 如能按照预期进度完成系统搭建及各类资源储备，预计2020考季可以初步检验： 项目预期于2019年5月完成雏形，初步实现专业课相关业务的一站式服务； 2019年3月份前，完成研究生储备5000人，真题库达到1万套，初步汇聚流量效应，获取用户的报考数据； 2019年3月份，有成体系的1V1课程品类上线，交付销售，并有对应的服务解决方案（课程交付、进度监控、报酬结算）； 2020考季，云私塾产品体系初步实现4000万的流水： 在云私塾产品体系下完成的支付（含其他产品） 云私塾产品在其他渠道的有效销售； 三、项目运营需要的支持1. 资金支持根据合规部门要求，相关支出需要以发票抵扣，但以下两项支出，金额较大，很难找到等额发票抵扣。且结算分散，研究生及传题大使较多，很难按照劳务报酬的形式完成结算，建议是否有专项资金支持。 研究生入驻的招募：如果按照10元/个有效入驻，按照1万名有效研究生计算，预计需资金投入10-20万元； 前期通过自有公众号、微信朋友圈、短信平台等渠道推广，后期考虑开发营销逻辑，成功邀请一人入驻，即可获得10元奖励。 真题库的搭建：如果按照3-5元/份真题，从市场上回收考研真题，按照2011-2018年有效计算，合计8年，达到3-5万份的储备，预计资金50余万； 开发真题回收系统，面向全网，自主注册传题，后台审核通过后按照预设价格为传题者进行结算，该系统可以保证真题库的不断标准化完善。 后期基于微信体系的重点推广（重点以校内公众号为突破），按照2元/个关注的获客成本计算； 2. 运营支持系统搭建过程中的运营工作，需熟悉这部分业务的同事进行支持。 考生、研究生两个服务号的日常运维及前期的小客服回复答疑，需新媒体运营的支持，主要是推文的撰写编辑； 研究生的招募、后期学生端的推广，需渠道支持，主要是微信公众号的投放、校园渠道的合作管理； 3. 系统支持3.1 建立产品公司现有业务逻辑，均要求支付体系接入鲨鱼系统。鲨鱼系统以固定产品为基础，一个产品对应一个价格，对应一个结算逻辑，在很大程度上不适用去现有的系统逻辑。 现有业务建立产品的逻辑： 真题及资料，上传审核通过后，系统自动在学员端上线一个产品，并通过消息对学员进行提醒； 1v1课程类，标准化产品创建出售后，每一笔订单的成本是波动的，根据学校、服务内容的不同，为研究生提供不同的档次的课时费；且1v1课程的某个订单详情理论上是可配置的； 第三方服务商的接入（对各大高校相关小团队的整合）； 3.2 财务支出现行逻辑中，在无发票的情况下，主要以劳务支出为主，无法实现类似助力、分销等逻辑下微信体系的支出路径。而基于微信生态体系后期的各类功能开发，将大量使用此类逻辑构建裂变增长模型。现有业务需要财务的支持： 学员、研究生的邀请扩散机制； 商品的开放分销机制； 第三方服务商接入的预留； 四、阶段性发力点专业课的“考生-研究生”交互体系，早期的搭建，主要是投入，且规模化前很难见效。该部分的基础功能，可以构建流量的循环增长模型，同时提升体系内未付费用户的活跃时长和留存时长，创造更多的营销机会；该部分的升级功能，依赖于课程结构的设置和销售能力，创造更多的商业价值。 产品阶段 时间节点 阶段性发力点 研究生入驻系统 2018年10月 以最快的速度完成研究生的招募入驻（线上研究生聚集的社区及线下定向推广）； 研究生问答系统 2018年11月-12月 继续推荐研究生的招录，小范推进问答系统的运营； 真题库的搭建(含前端检索系统和回收系统) 2018年12月-2019年2月 稳定运营问答系统及研究生入驻系统；全面发力，扩散真题回收系统，完成真题库的搭建； 平台服务信息结构的搭建 2019年3月 梳理与专业课相关的课程、服务，通过一定的机制，整合进入已有系统。 1v1的课时确认系统 2019年3月-4月 完成1v1课程交付系统的开发，可以实现用户-研究生的服务交付及监控、酬劳支付和对账。]]></content>
      <tags>
        <tag>项目介绍</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[日常型需求]]></title>
    <url>%2Fposts%2F23557%2F</url>
    <content type="text"><![CDATA[用户信息文案调整的需求2018-11-111. 认证审核通过的模板消息内容：原内容：恭喜您通过云私塾的入驻审核，正式成为云私塾的认证学长。 调整为：恭喜您通过云私塾的入驻审核，正式成为云私塾认证学长。问答功能正在开发中，为了保证新东方百万考研学子的需求匹配，学长达到5000人，我们将集中向学长推广。 云私塾链接PV统计的需求2018-11-07一、需求详情为了统计带参图文的浏览量，从而分析对应渠道的质量，故此由后端协助给出了一个解决方案： 我们自己的服务器url + 带参图文的url 后端统计对应url的pv数据。 后端服务器给的url地址为：http://y.koolearn.com/senior/v1/url-visit/redirect?url=指向图文地址 云私塾 - 关于带参二维码的配置需求2018-11-01一、概述微信为认证的服务号提供生成带参二维码的功能，分临时二维码好永久二维码，具体微信的开发文档如下： 参考文档：https://mp.weixin.qq.com/wiki?action=doc&amp;id=mp1443433542&amp;t=0.376179226179156 用例： 通过带参二维码，来统计研究生的关注来源，从而确定研究生是由哪个渠道入驻； 通过带参二维码，实现裂变分销系统的搭建（公众号粉丝裂变）； 其他应用等； 影响： 开通服务器配置的服务号，将丧失自定义菜单的能力；菜单的修改，需要技术后台配合完成； 二、需求详情1. 需为服务号配置服务器根据对应的开发需求，生成带参二维码，且利用带参二维码完成对用户信息的统计，需要对服务号进行服务器配置，并进行相关功能的开发。 2. 生成带参二维码2.1 研究生的入驻路径如下 2.2 后端数据存储后端新建数据表格，完成对应关注数据的存储，定期导出。 建议： 基本数据，可以对所有关注服务号的用户数据进行存储，已备后用；不是通过带参二维码进行关注的用户，其关注来源，可以使用微信数据后天的固定字段进行记录。 “入驻数据“可以为空，关注服务号的用户，有可能不进行入驻申请； 2.3 带参二维码链接导出服务器配置完成后，请求导出300个永久带参二维码，以原始链接形式给出。 参数范围：YJSRZ1 - YJSRZ300 研究生入驻首字母大写，从1-300编号。 二维码原始地址：非图片地址，我们会利用这个原始地址，利用草料等工具，生成带logo的新二维码，用于推广。 2.4 每个月后端配合导出的数据每个月，需要后端配合导出这300个带参二维码下的关注数据，数据项如下。 基本信息： 关注来源：除开已经生成的带参二维码外，其他正常来源，例如服务号正常二维码、名片关注等请按照微信的标准字段标记； 关注时间：用户关注服务号的时间； 取关时间：用户取消关注服务号的时间； 入驻信息：可以为空 此处通过微信绑定的信息，匹配服务器入驻数据，存储对应的入驻信息。 三、以后可能的需求带参二维码，以后可能的需求： 研究生的邀请入驻：每个研究生可以选择邀请其他人入驻，每邀请成功入驻1人，结算10元；改动能需要实现服务器自动生成带参二维码并和对应研究生绑定； 学生端服务号的助力分销等；也要求自动生成带参二维码。 以上两种情况，多数情况下使用临时码，也有可能使用永久码。]]></content>
      <tags>
        <tag>运营；</tag>
        <tag>文案调整；</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[云私塾 - 研究生问答系统需求说明文档]]></title>
    <url>%2Fposts%2F21033%2F</url>
    <content type="text"><![CDATA[云私塾 - 问答系统-考生端需求说明文档文档说明： 文档版本号： 2.1.0 文档编号：yss-wd-1 YSS_PRD_2_WD 文档密级： 内部文档 归属部门/项目： 国内考试事业部 产品名： 云私塾 子系统名： 研究生问答 编写人： 付荣 编写日期： 2018-10-22 文档核心内容：主要描述了云私塾二期-问答系统功能的开发需求。 页面原型地址如下：https://weixiaodeyu.github.io/wenda/#g=1 一、产品概述1. 概述关于云私塾第二期项目，我们将考生-研究生的交互模块拆分为三个部分进行，研究生入驻系统、问答系统、资料检索系统。 目前已完成研究生入驻系统部分的开发，该文档将对第二期-研究生问答部分的功能开发需求进行详细描述。 前端系统： 首页 A （1个主页面，2个子页面） 登录绑定 B （1个主页面，4个弹窗） 搜索页 C（1个主页面，2个子页面） 最新问答 D（1个页面，2个状态） 专业主页 E （3个页面，7个子状态） 研究生主页 F（2个页面，4个子页面，2个弹窗） 我的主页 H （7个页面） 后端系统： 学员管理列表及详情页； 问答管理列表及详情页； 订单管理列表及详情页； 2. 问答业务的整体流程图 主要业务流程明确简单，但人工介入后会产生很多附加状态，相对复杂。 二、页面流转逻辑1. 考生前端页面详细框架页面的整体结构见下图，虽然涉及页面较多，但主要功能单一，本次涉及信息录入的点共计三处： 信息录入: 登录绑定； 目标修改； 问答； 其他界面均为数据的调用和状态判断后的展示。 2. 考生端主要页面跳转 3. 考生端各主页面前置条件 页面名称 页面编号 页面前置条件 首页 A 进入页面时无前置条件； 登录绑定 B 进入页面时无前置条件； 搜索页 C 进入页面时无前置条件； 最新问答 D 进入页面时无前置条件； 专业主页 E 进入页面时无前置条件；关注时，校验是否登录，登录后返回当前页； 研究生主页 F 进入页面时无前置条件；点击提问输入框时，校验是否登录，如未登录，则提示跳转页面B，完成绑定登录后返回当前页；点击“关注”时，校验是否登录，登录后返回当前页； 我的主页 H 访问我的主页时验证是否登录，如未登录，则跳转页面B，完成绑定登录后自动进入； 三、考生前端页面详情1. 首页 A首页可以直接访问，不强制用户完成授权和绑定。 1.1 首页的页面结构 1.2 页面原型1.2.1 首页-未登录 页面A-1 顶部菜单栏，显示“登录”。 1.2.2 首页-已登录 页面A-2 顶部菜单栏，显示“用户头像”。 1.2.3 首页-菜单栏 页面A-3 顶部菜菜单栏的展开状态 1.3 页面需求详细说明1.3.1 登录状态说明： 未登录 已登录 1.3.2 顶部轮播Banner说明 预留五张图的位置，3s间隔，循环滚动，点击可跳转对应页面或图文； 如图片数量不足五张，则显示实际张数；最少三张图片； 1.3.3 学长搜索 搜索框内，刷新页面时计算库内研究生人数进行显示； 点击搜索框后打开“搜索页 - 页面编号C ”； 1.3.4 学长列页 学长列表，优先抓取最近回答过问题的学长进行展示； 每个研究生的信息为一个版块，全区域可点，点击跳转“研究生主页 - 页面编号F ” 2. 登录绑定 B该页面完成用户微信与手机号的绑定，用户访问该页面时，拉取用户微信授权，生成学员ID。 该页面所有信息必填 2.1 页面结构 2.2 页面原型 2.3 页面需求详细说明备注：需求同7.2.2 2.3.1 顶部菜单栏 顶部菜单栏不再显示头像和登录按钮； 2.3.2 头像及用户ID 用户授权：进入该页面时拉取用户授权，获取用户头像、性别、昵称等微信公开信息； 分配学员ID：用户授权后生成唯一学员身份ID与微信绑定，该绑定与手机号是否绑定无关，授权后即获取唯一学员ID； 2.3.3 目标院校填写 目标院校的选择规则，与研究生入驻的选择规则相同。 选择路径：选择省份-选择学校-选择专业（专业学位和学士学位）； 计划报考年份：预置为2020.2021.2022； 2.3.4 手机号绑定该部分进行微信与手机号的绑定。 校验手机号的正确性； 校验验证码的正确性； 2.3.5 完成绑定 空值检测：提交时检测是否有未填项，并进行提示； 绑定成功提示： 该弹窗1秒后，页面刷新跳转到首页； 点击“回到首页”立即跳转首页； 3. 搜索页 C该页面，主要引导用户通过“ 学校 - 专业 ”来检索研究生，输出结果为专业主页； 3.1 页面结构 3.2 页面原型 3.3 页面需求详细说明3.3.1 院校检索 目标院校的选择规则，与研究生入驻的选择规则相同。 选择路径：选择省份-选择学校-选择专业（专业学位和学士学位）； 点击“确定”后进入对应的专业主页； 3.3.2 检索记录 页面底部，显示检索记录，方便用户快捷跳转和切换，默认显示一行，超出部分省略，最多显示5条。 4. 最新问答 D该页面按照时间倒叙显示最新产生的问答数据。 4.1 页面结构 4.2 页面原型 4.3 页面需求详情4.3.1 问答内容备注：需求同5.3.4 问题： 提问者头像； 提问者昵称 提问时间； 问题内容； 回答： 回答者头像 回答者昵称； 回答时间； 回答内容； 院校及专业标识（显示固定长度，超出部分省略） 立即提问：点击后，进入研究生主页； 红包：显示红包金额； 4.3.2 页面底部 页面底部，始终顶层显示”立即找学长“按钮，点击跳转“搜索页 C“； 页面信息上划时，显示正在加载的状态； 如该页面已加载所有信息，用户上划时，提示“已加载全部”； 5. 专业主页 E5.1 页面结构 5.2 页面原型 该页面分为一个主页，三个Tab页面，共计8种状态；默认载入页面时，页面停留在第二个Tab2 —— 学长学姐页面； 5.2.1 Tab1：初试科目页 2.2.2 Tab2：学长学姐 - 3种状态 学长学姐Tab分为三种显示状态，同专业不同院校的数据查询，唯一判定条件为专业code。 状态1： 学长学姐有数据；默认显示5条数据，上划加载更多； 状态2：本专业无学长学姐，其他院校同专业有研究生数据；默认显示5条数据，上划加载更多； 状态3： 本专业无学长学姐，且其他院校相同专业也没有学长学姐；显示无数据提示； 5.2.3 Tab3：交流问答 交流问答共有一个页面，四种状态。同专业不同院校的数据查询，唯一判定条件为专业code。 状态1：本专业下有问答，返回问答； 状态2：本专业有研究生但无问答，返回研究生； 状态3：本专业下无研究生物问答，推荐同专业其他院校的问答；本专业下无研究生无问答，同专业其他院校有研究生无问答，推荐同专业其他院校的研究生； 状态4：本专业无研究生无问答，同专业其他院校也无问答和研究生，显示对应提示页； 5.3 页面详细需求说明该部分页面状态较多，根据不同状态返回对应的页面数据，状态相关展示的变化已经于原型部分进行了说说明，这里将不再赘述。 5.3.1 顶部专业Banner 校徽：院校的校徽，调用之前扒取的校徽数据，科研院所和没有校徽的院校，统一使用设计的院所和校徽LOGO； 校名：设计师给出固定长度的字符限制，超出部分省略； 专业代码：6位代码， 根据专业属性，显示专业学位/学术学位； 专业名称：显示专业名称，固定长度字符，超出部分换行显示； 关注：点击可以关注该专业，关注状态可切换。 关注人数：返回该专业的关注数量； 5.3.2 Tab1: 初试科目 样式同研究生补充资料审核处选择研究方向的样式；返回该专业下不同研究方向的初试科目； 注意： 排序； 方向标注全日制/非全日制； 5.3.3 Tab2：学长学姐 昵称和头像：获取微信昵称和头像； 学校和专业*：限制一行的长度，超出部分省略； 初试科目：限制一行的长度，超出部分省略； 标签：固定长度，按排列显示，如部分缺失，则后面的标签自动前置； 5.3.4 Tab3：交流问答该页面共计1个主页4个状态，页面需要按照不同状态，显示不同数据。 问答模块的数据需求，需求同4.3.1。 6. 研究生主页 F该页面主要用来呈现研究生的信息，并主要突出研究生提供的服务，例如资料（暂不开发该模块）、问答、辅导等； 6.1 页面结构 6.2 页面原型 该部分共计一个主页面，两个子页面，分为4种状态：调剂录取/第一志愿录取、有答疑内容/无答疑内容 F-1 ：研究生为第一志愿录取，该研究生下有答疑数据； F-2：研究生录取方式为调剂录取，tab选择“提问答疑”，答疑数据； F-3：第一志愿录取，tab选中 “提问答疑”，该研究生下暂无答疑数据； F-4：录取方式第一志愿录取，tab选中“辅导提升”； 6.3 页面详细需求说明6.3.1 研究生信息banner 顶部研究生信息部分需求详情： 关注按钮：点击后变为“已关注”，关注状态可切换； 昵称、学校、专业控制一定长度，超出部分省略； 个人简介：如果用户输入了个人简介且审核通过，则显示用户输入内容；如用户为输入个人简介信息，则统一显示如下信息： &gt; 同学们好，我是XXXXX（抓取学校名称）XXXXX（抓取专业名称）XXX（抓取年级）XXXXX（抓取用户昵称）学长/学姐（按性别显示，如性别位置，则显示学长），很高兴能来到这里，如果你在备考过程中有任何不清楚的地方，都可以通过这里向我提问哦，我会尽快给你回复的！我在XXX（抓取学校名称）等你，加油哦！&gt; &gt; 示例：同学们好，我是北京大学应用语言学2018级呆呆喵学姐，很高兴能来到这里，如果你在备考过程中有任何不清楚的地方，都可以通过这里向我提问哦，我会尽快给你回复的！我在北京大学等你，加油哦！&gt; 状态标签 该部分为几个核心字段的标签，字段信息分别为： 录取方式：第一志愿录取/调剂录取； 年级：入学年份； 学长学姐：根据性别返回； 初试总分：如有则显示，没有则不显示。 初试信息：如用户填写了补充信息，则显示该模块，如用户未填写补充信息，则不显示该模块； 录取方式为第一志愿录取显示： 初试科目； 录取方式为调剂录取显示： 原报院校； 原报专业； 原初试科目； 6.3.2 提问答疑 提问咨询部分： 输入框限制100字符，根据输入内容的量来调整输入框高度； 发送问题前调用敏感词屏蔽库，校验内容是否有违规信息，如有则弹窗提示，无违规后调起支付弹窗完成支付发送； 提问违规弹窗： 支付弹窗： 提问注意事项： 点击后弹出效果，显示一些提示内容； 回答记录：正常显示该研究生回答的问题，如果该研究生无问答记录，则显示以下内容： 6.3.3 辅导提升 所有专业公用一套标准化课程，点击“立即购买”进入课程详情页（一个图片），引导用户填写咨询信息； 购买用户的头像，只显示固定个数，超出部分省略号代替； 已有XX名同学购买，可能需要进行假数据的填充； 7. 我的主页 H7.1 页面结构 7.2 页面原型及需求详情7.2.1 我的主页-首页 目标院校/目标专业：显示其绑定时输入的目标信息，固定长度显示，超出部分省略； 我的关注：该菜单，点击后，有子菜单，分别为：我关注的专业、我关注的学长 7.2.2 目标院校变更 H-3 该页面需求，同需求同2.3。 7.2.3 我的问答 所需数据均为系统中的数据，正常返回； 红包状态：0元/3元/5元/10元 问题状态：已回答/待回答/已退款 问题状态提示： 待回答的问题，问题左下角提示： 已退款时，红包为灰色，且问题左下角提示： 已回答的样式： 当页面无问答数据时，显示无问答提醒，并引导用户搜索学长进行提问。 问题超时提醒： 提醒模板： 问题已回复提醒： 提醒模板： 7.2.4 我关注的专业 查看专业详情：点击跳转专业主页； 专业检索：点击跳转搜索页； 目的：考生添加关注的专业后，则该该专业有研究生入驻（入驻审核通过）、有被展示的问答更新（有问答，且选择被展示）时，为关注该专业的考生推送提醒. 提醒模板： 研究生入驻提醒： 的 新问答展示提醒： 的 7.2.5 我关注的学长 学长标签分为两种状态： 填写了补充资料：根据录取方式，显示对应的初试科目信息； 未填写补充资料：不显示初试科目等相关信息。 找学长：点击跳转搜索页面 目的：考生添加关注的学长后，则研究生补充资料更新、有新问答被展示时，推送系统消息提醒。 7.2.6 消息中心 消息： 区分已读和未读状态。 消息的读取状态和消息对应的模板消息联动，如果用户访问了模板消息，则消息已读；如果用户未点击访问模板消息，则消息未读； 查看详情：跳转我的问答界面； 7.2.7 联系我们 联系我们： 小助手二维码： 小助手微信号：yunsishu01 8. 学生端消息提醒8.1 提醒类型及触发场景 8.2 模板消息样例所有模板消息，均已在对应公众号中完成了添加，请按照模板ID进行匹配。 消息名称：提问成功提醒 触发条件：问题发送成功且完成支付 发送规则：提问成功时发送 模板标题：问题提交成功通知 模板ID：bctu7GlzmTacDnjMKCuimMvK33EsUfFkxPY1e6ng3xk 内容示例： &gt; 您的问题已经以八百里加急发送给学长，请等待回复。&gt; 您的问题：问题内容&gt; 提交时间：2017年6月22日&gt; 如果你的问题48小时内未被回复，则您支付的酬金将原路退回。如有任何疑问请联系小助手微信：yunsishu01&gt; 消息名称：问题被回答提醒 触发条件：问题被回复时，收到提醒 发送规则：问题被回复时，立即提醒 模板标题：问题处理结果提醒 模板ID：ig5o_2nPIgDJTzOUf9w-Epk29ZOOb577d19SvkvPuE8 内容示例： &gt; 您好，您的问题已被回复。问题：XXX&gt; 提问时间：抓去提问时间&gt; 回复内容：抓取回复内容&gt; 如果您对学长的回复有任何疑问，可以继续追问。如学长的答复不满意，可以向小助手反馈哦，小助手微信：yunsishu01&gt; 消息名称：问题违规提醒 触发条件：问题未被回复时，管理员判定为违规 发送规则：问题被判定违规时发送，提醒一次。 模板标题：违规通知 模板ID：fcANNojVMfkKCtm68csS0RT8ss5N0OMlctFxTA0oBr4 内容示例： &gt; 您好，您的提问因包含敏感词，已被判定为违规，您支付的酬金将被原路退回，请修正后重新提问。&gt; 违规内容：违规原因&gt; 处理方式：问题被拦截，酬金原路退回&gt; 如果您对该处理意见有任何疑问，请联系小助手反馈，小助手微信：XXXXX。&gt; 消息名称：提问超时提醒 触发条件：提问48H未被回复 发送规则：未被回复时，提醒一次 模板标题：提问失败通知 模板ID：k9fFXEb2i2WL6fgM_hoiieHkunP1xHchYaw3rsnmgbM 内容示例： &gt; 抱歉，您的提问48H内未被回复，问题已关闭，酬金将原路退回您的零钱。&gt; 提问问题：问题内容&gt; 失败原因：48小时内未被回复&gt; 时间：2014年7月21日 18:36&gt; 学长可能漏看了，您可以再次提问哦。如有其他需求，可以联系小助手微信：XXXXXX&gt; 消息名称：学长入驻提醒 触发条件：关注的专业，有新学长入驻 发送规则：每入驻一个，提醒一次 模板标题：入驻审核结果通知 模板ID：rOglTA0R0GKxXu3QKU8Xda9lKoNZsQ4pTbg9RfGTmHQ 内容示例： &gt; 同学您好，您关注的XXXX（北京大学材料物理专业）有新的学长入驻，快去提问吧。&gt; 姓名：张三&gt; 专业：计算机科学&gt; 高校：北京大学&gt; 审核通过时间：2018-10-01&gt; 点击可以进入专业主页哦。如有任何疑问，请联系微信小助手：XXXXX&gt; 消息名称：问答更新提醒 触发条件：关注的研究生下有新问答被展示 发送规则：每展示一个提醒一次 模板标题：用户提问通知 模板ID：KYeY65ggFIht_0B26v66HF78uGR0AU–9RZA0Ls7BJY 内容示例： &gt; 您好，您关注的XXXXX（北京大学材料科学与工程专业的XXX学长）有新同学提问，快来围观。&gt; 问题内容：内容&gt; 问题类型：专业课相关&gt; 发生时间：XXXX&gt; 如果您在备考中有任何问题，也可以向学长提问哦。有任何使用中的问题，请联系小助手：XXX&gt; 四、研究生前端页面详情1. 个人主页 W1个人主页已于第一版，研究生入驻时设计完成，本次只是在已有界面基础上，增加菜单栏，从而丰富该页面的内容。 页面原型如下： 增加两个菜单，分别为：我的问答、收支记录。 2. 我的问答 W32.1 页面结构 2.2 页面原型2.2.1 主界面原型 2.2.2 问题回复界面原型 2.3 页面需求详情2.3.1 问答列表 待回答的问题 红包下方，显示问题状态：待回答； 底部提示：48小时未回复，系统将自动完成退款。 点击立即回复，进入回复入口。 已回答的问题 红包下显示状态：已回答； 显示问答的各项属性； 已退款的问题 红包显示状态：已退款，红包为灰色； 底部显示退款原因： 1.超时退款原因，内容固定：问题超时未回复，已退款； 2.发起的退款：显示实际退款原因（可能超过一行，需要做适配） 2.3.2 问题回复界面 问题回复的提示：回复问题，即可获得X元奖励哦！ X为红包金额，根据红包大小返回数据。 输入框的高度，需要保证能够输入100字，固定高度； 点击“立即回复”后，弹出二次确认的弹框，避免误触发送；二次确认的弹窗可以关闭； 问题回复的提示，可能需要根据用户反馈频繁修改，请做好预留； 回答问题点击提交时，需要校验答案是否违规，如违规，则弹出以下提醒。 3. 收支记录 W43.1 页面结构 3.2 页面原型 3.3 页面需求详情3.3.1 收支条目的六种状态 收入，审核中； 收入，已入账； 收入，已退款（只有审核中状态的问答可被退款）； 退款的收入，红包置灰，且无+/-状态； 收入，回答违规； 如回答后，系统未识别违规，但审核期内，人工校验位违规，则可改变问答状态为违规（审核中可改），收入无效，不执行退款操作。 状态改变时，会有对应的违规提醒。 支出，已到账 余额提现到账。提现成功后，进行提现余额的减去。 支出，提现失败 支付商户平台余额不足时，提现失败，以及其他系统原因提现失败。 提现失败后，不作金额的加减，保留记录即可，并通过邮件形式对管理员进行预警，提醒余额不足。 3.3.2 提现小额的即时提现为该系统的一个核心创新点。单次小额1-10元的收入，如果累计提现，漫长的等待和最终较少的收益容易造成用户心理落差，所以即收即提，不累计的形式，可以放大用户的喜悦感。 总收入=可提现余额+审核中+已提现金额； 立即提现：3分钟内，只能发起一次提现（此处主要防止连点等操造成多发钱）。 本次提现：输入的金额不能大于可提现余额，提现时进行校验； 4. 研究生端消息提醒4.1 提醒类型及触发场景 4.2 模板消息样例所有模板消息，均已在对应公众号中完成了添加，请按照模板ID进行匹配。 消息名称：新问题提醒 触发条件：研究生有新问题时提醒研究生回答问题 发送规则：收到问题时立即发送，间隔24小时后如问题未被回复，则再次提醒。每个问题最多发送两次提醒。 模板标题：答疑提醒 模板ID：j9cqLuQIa45dhtSExgdYUy19_jQvblQapuDVPS0rTTg 内容示例： &gt; 您好，您入驻的XXXXX（北京大学XX专业）有学员向您提问，详情如下。&gt; 申请人：微笑的鱼 （抓取提问人的微信昵称）&gt; 问题内容：问题内容&gt; 时间：抓取提问时间&gt; 请及时回复，谢谢！如有任何疑问可咨询小助手微信：yunsishu01&gt; 消息名称：回答违规提醒 触发条件：研究生的回答被管理员判定为违规 发送规则：后台修改问答状态后，立即发送提醒 模板标题：违规通知 模板ID：PXS4_TkIqdRV0d_Pc7kT8yGo5xeXVAGJqYR6_aCy3SQ 内容示例： &gt; 您好，您的回答内容包含违规字段，系统已拦截。&gt; 违规内容：抓取回答内容&gt; 处理方式：已拦截，红包退回。&gt; 如有对以上内容有疑问，请联系小助手微信号：yunsishu01&gt; 消息名称：回答成功提醒 触发条件：研究生成功回答用户提问后发送提醒 发送规则：回答成功后立即发送 模板标题：服务完成通知 模板ID：p1ErQuli4Zp6k0uk_XgFv8Se1PisPVaOT9SDrfBNId8 内容示例： &gt; 您好，您的回复已成功发送！&gt; 服务内容：提问答疑&gt; 完成时间：回答时间&gt; 如果该问题用户已附加红包酬谢，则收入计入审核中。如有任何疑问请联系小助手微信：yunsishu01&gt; 消息名称：入账提醒 触发条件：某笔收入从审核中状态变为可提现余额时提醒 发送规则：状态转变时提醒一次 模板标题：入账通知 模板ID：0bkQnuspaZVHdtxGo2Vt5c3_8Hhjs_ANCk0x8HPpd_M 内容示例： &gt; XXXX（用户昵称）您好，您给XX（该笔收入对应问题，提问者的昵称）的答疑收入已通过审核，完成入账。&gt; 金额：3.0元&gt; 入账时间：2015年7月27日&gt; 如有任何疑问，请随时与小助手联系，微信：yunsishu01&gt; 消息名称：提现成功提醒 触发条件：研究生余额提现，提现成功 发送规则：提现时发送一次 模板标题：提现成功通知 模板ID：1ZkC0wZZvk5DfD7j4k8PDYjO6wGGMiZ5rBMjADd2tyU 内容示例： &gt; 您好，您的提现已到账，请注意查收。&gt; 申请时间：2018年5月20日 12:23:30&gt; 提现金额：99.99（元）&gt; 提现方式：微信支付到零钱&gt; 到账时间：2018年5月25日 12:10:30&gt; 备注说明：请查看微信支付及零钱余额，付款方新东方迅程（北京）有限公司。&gt; 如有任何疑问，请随时与小助手联系，微信：yunsishu01&gt; 消息名称：提现失败提醒 触发条件：提现失败 发送规则：提现失败时发送一次 模板标题：提现失败通知 模板ID：lcxQDUs-12Zv6ObE053T6_BQ-LprTJ9ogTeAfdyBVrg 内容示例： &gt; 您好，本次提现失败，请联系小助手反馈问题。&gt; 提现金额：2400元&gt; 提现方式：微信支付到零钱&gt; 失败原因：平台余额不足。&gt; 请与小助手联系充值后重新提现，微信：yunsishu01&gt; 五、后台管理系统1. 学员管理1.1 学员管理信息结构图分为两部分：数据表的信息结构、学员管理详情的信息结构。 学员管理详情内，问答表格的数据、订单表的数据，可以根据问答管理和订单管理数据进行返回。 1.2 页面原型1.2.1 学员管理数据表 按照绑定时间倒序排列，学员ID，按照X00001命名，预留10W个。 1.2.2 学员管理详情 根据学员ID，返回各项数据表，如为空，则不返回。 问答记录，请通过问答列表查询返回。 目标院校学长学姐：根据所定目标，动态返回对应结果。 2. 问答管理2.1 问答管理信息结构图 同样分为问答管理数据表、问答管理详情。 2.2 页面原型 问答管理列表，不显示违规问题和回答。请在服务器端保留违规记录（记录违规的问题和内容全部内容，提示一次违规，记录为一条数据），一定时间后导出，便于对敏感词库的优化管理，感谢。 2.3 页面需求详情此处对页面管理详情进行说明，提问信息和回答信息不作赘述。 基本信息 类型：考生问答 此处为考生问答，随着系统完善后续会增加其他类型。 问题状态：待回复/已回复/已超时 只会拥有一个状态 状态变更 违规状态：正常/问题违规/回答违规 互斥 默认状态为正常 Button问题违规：问题未被回答时（无回答），且未超过48H，显示该按钮； Button回答违规：问题被回答时（有回答），且在3天期内时，显示该按钮； 这两个按钮，不会同时出现。其他状态不显示这两个按钮。 展示状态：展示/不展示 互斥 默认状态为不展示 展示：前端界面可看到； 不展示：曲线前端界面展示。 退款状态：正常/超时退款/退款审批中 互斥 默认为正常 正常：问答正常，不退款 超时退款：问题48小时未被回复，自动退款； 退款审批中：申请退款审批中； 退款完成：申请退款完成； 违规提醒：人工筛选违规时，推送违规模板消息。 问题违规，则消息推送给学员ID； 回答违规，则消息推送给研究生ID； 退款申请，调起审批流程（审批流程接入平台部，娄敏老师） 3. 账目管理3.1 问答订单列表3.1.1 问答订单列表信息结构图 3.1.2 问答订单原型 3.2 研究生提现记录3.2.1 研究生提现记录信息结构图 3.2.2 研究生提现记录页面原型 3.3 财务对账表3.3.1 财务对账表信息结构图 3.3.2 财务对账表原型 4. 研究生服务管理4.1 研究生服务统计表4.1.1 研究生服务统计表信息结构图 4.1.2 研究生服务管理表原型 统计表原型 详情页原型]]></content>
      <tags>
        <tag>问答系统</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[问答业务的业务流程]]></title>
    <url>%2Fposts%2F52512%2F</url>
    <content type="text"><![CDATA[问答的业务流程 问答的业务逻辑图 问答的支付和退款要求 问答主要通过微信商户支付平台完成用户的收款和对研究生的问答酬劳发放，涉及到企业支付到零钱，同时涉及到退款审批。 问答类业务：学员不可以发起退款，退款详细规则如下。 退款规则：不支持无理由退货 退款条件1：提问并支付后，48H未得到回复，则支付金额自动退回（系统自动控制）； 退款条件2：已经实际发生，且已完成的问答，问答完成72H内（超过72H后不退款），如遇到用户投诉回答不合格，核实无误的，由管理端发起退款； 退款审批： 运营人员核实无误后发起退款 - 陈瀚婧老师 - 甘源老师 - 财务老师 - 系统完成退款（审批流程从鲨鱼调用接口） 问答管理列表]]></content>
      <tags>
        <tag>云私塾</tag>
        <tag>考研问答</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[云私塾--鲨鱼系统产品衔接需求说明]]></title>
    <url>%2Fposts%2F63663%2F</url>
    <content type="text"><![CDATA[云私塾–鲨鱼系统产品衔接需求说明引言：云私塾项目模型 一、 云私塾主要业务流程1. 主要业务内容 业务线名称（产品） 业务线介绍 满足的市场需求及作用 问答 考生通过系统向研究生提问；研究生通过系统回答考生问题； 某些碎片化信息的咨询；通过问答来促活，增加用户对平台的信任度；轻付费问答，用培养用户的付费习惯； 真题（这次讨论暂不涉及） 每所高校每个专业每年的研究生考试真题；回收并出售给考生； 真题为考研备考的极刚需内容；搭建相对完善的真题库，将作为流量诱饵，形成流量池；轻付费或免费，构建对应的用户裂变增长逻辑； 资料笔记 每所高校每个专业的备考复习笔记；回收并出售给考生； 作为备考过程中相当重要的笔记，是大多数同学备考专业课过程中不可缺少的内容，尤其是对于跨考同学。增加产品丰富度，提高可信度，一定时间后完成数据沉淀； 1v1辅导 研究生通过云私塾向考生提供1V1的课程辅导； 在专业课备考过程中，需要学长学姐进行辅导；高客单价的产品，承担主要的收入来源； 以上为云私塾涉及专业课的主要业务线，但整个体系在完整运行并有一定的数据沉淀后，可以将公共课的对应录播课程植入到对应的科目下，完成类似学长推荐课程的逻辑，将大大增加学生对课程的可信度，提高转化。而同时，公共课端，可以将公共课与专业课辅导进行打包，形成更加完备的考研直通车产品。 2. 各部分业务流程图2.1 问答业务 问答的业务逻辑图 问答的支付和退款要求 问答主要通过微信商户支付平台完成用户的收款和对研究生的问答酬劳发放，涉及到企业支付到零钱，同时涉及到退款审批。 问答类业务：学员不可以发起退款，退款详细规则如下。 退款规则：不支持无理由退货 退款条件1：提问并支付后，48H未得到回复，则支付金额自动退回（系统自动控制）； 退款条件2：已经实际发生，且已完成的问答，问答完成72H内（超过72H后不退款），如遇到用户投诉回答不合格，核实无误的，由管理端发起退款； 退款审批： 运营人员核实无误后发起退款 - 陈瀚婧老师 - 甘源老师 - 财务老师 - 系统完成退款（审批流程从鲨鱼调用接口） 问答管理列表 2.2 资料类业务 资料类业务逻辑图 资料类业务的支付和退费 资料类业务的支付：调起鲨鱼系统的产品母版完成支付； 资料类业务：资料主要为电子版，不支持无理由退货； 退款规则：根据鲨鱼系统7天内可以发起退款的规则，如发现资料有任何问题，可以联系客服进行处理（我们自己的项目客服），核实问题后，发起退款； 退款审批：运营人员核实无误后发起退款 - 陈瀚婧老师 - 甘源老师 - 财务老师 - 系统完成退款 资料销售管理列表 2.3 1v1的业务逻辑 1v1业务逻辑图 1v1业务的支付和退费 1v1业务，收入逻辑目前确定为接入鲨鱼产品系统，但具体的业务交付，及最后的研究生酬劳统计支付正在探索中。 1v1的业务： 结算规则： 按实际发生的课时数，按照课时酬劳*课时数给研究生进行结算； 退款规则： 退还未发生的部分的课时费； 更换研究生需求： 如用户对该辅导老师不满意，我们提供更换老师、退款两个选择，优先提供更换研究生的服务； 1v1的订单管理及订单绑定 订单绑定指的是将用户购买的订单与对应辅导的研究生进行绑定，并确定对应的课时费等合同协定内容。 二、 产品衔接的目的因云私塾项目中涉及各类支付产品，在与财务相关老师沟通后，从节省开发成本的角度考虑，财务老师建议我们将产品管理仍然接入鲨鱼的产品管理系统中。现就云私塾相关产品基本情况及业务的简单流程进行说明，并基于我们对鲨鱼系统的理解，给出云私塾产品体系与鲨鱼系统产品管理系统的基础解决方案，希望将现有的一些产品逻辑接入到鲨鱼系统中，以减少相关的技术技术开发成本。 三、 需求详情1. 云私塾项目涉及到的产品及需求特点1.1专业课产品的多样性 研招单位共计842所，剔除涉及“党政军”相关的院校和部分三本学院后保留了634所高校； 634所研招单位，共计对应专业45061个，每个专业均对应各类商品，含问答、笔记、辅导等； 独立的考试科目为29896个，每个考试科目对应商品为考试真题（2011-2020年）； 1.2 用户需求的分散性 每年200余万考生的需求分散在45061个专业中，无法精确获知每个用户的需求倾向以及付费意向，需要大量的供给端服务储备，来对考生进行自由匹配（这是早期问题，后期可以对用户的报考院校做数据调研及储备，从而有效优化产品结构）； 每个商品细分下来可以匹配到的用户数范围大概在1-100人之间（有的专业每年只招1个人，有的专业较大，会招生几十人），每个专业均有需求，但需求旺盛度差异极大； 2. 业务流程中的用户角色和对应行为 考生 云私塾平台 研究生 a.购买提问服务； b.购买真题； c.购买笔记； d.购买辅导 提供服务中转功能， 收取服务费，并监督服务质量和服务效果。 1.回答考生问题，获得问答酬劳； 2.提供真题、笔记，获取售卖分成； 3.提供辅导，按辅导课时获取酬劳； 3. 商品类型介绍 商品及简介 预计商品数量 考生端预计价格区间 考生支付场景 商品的成本 （价格区间的百分比） 研究生结算场景 支付及结算频次（相对） 问答:向研究生发起一次提问 &gt;=45061*5 （45061个专业，平均每个专业5个问题） 0-10元/次提问 微信支付 前期100%； 后期将逐渐控制80%； 微信支付； 企业支付到零钱； 极高 考研试题：每个考试科目对应的试题 &gt;=29896*8 （29868个科目，8年） 3-20元/份试题 微信支付 10%，可调整； 微信支付； 企业支付到零钱； 高 考研笔记：每个考试科目对应的复习笔记 &gt;=29896*2 （29896个科目，平均每个科目2份相关资料） 100-1000元/份资料 微信支付 60%，可调整； 按月劳务支出； 中 1v1辅导：购买研究生的辅导课程 &gt;=45061 （45061个专业，每个专业至少对应一个辅导产品） 300-500元/课时； 按照不同课时数量包装成不同的标化产品，并进行不同程度的优惠； 微信支付 银行转账等 100-200元/课时； 按月劳务支出； 低 4. 云私塾现有的产品创建路径 实际使用中的问题： 云私塾产品种类繁多，如通过现有鲨鱼产品管理系统进行人工创建，按照创建一个产品20min的时间计算，将耗费大量的人工时间做机械劳动； 产品审核的工作量同样庞大； 使用不便，无法适应于云私塾45000余专业，总计约为20万产品的上架管理； 根据现有云私塾的产品和鲨鱼系统产品创建的逻辑，无法满足后续的业务发展需要，并就此和财务老师进行了沟通，财务老师根据我们的实际业务需求，给出了相关建议。 5. 云私塾-鲨鱼系统产品衔接方案 目的： 一方面是将云私塾的产品财务逻辑纳入已有的鲨鱼系统，便于财务对账，减少开发量，节省时间； 另一方面减少产品运营部分的人力投入； 优势： 可以实现从产品入库到产品出售的全流程化，减轻相关工作的人力投入，在一定程度上实现“轻运营”； 在一定程度上实现云私塾端产品框架调整的便捷性，便于项目基于市场反馈进行快速调整优化（前端产品的上下架调整不影响鲨鱼端的相关设定）； 核心的财务流程继续保留在鲨鱼系统中，节省开发成本和财务老师的时间； 方案框架示例图： 四、云私塾端订单管理结构图 待确定：鲨鱼系统中，退款是按照商品进行计算还是按照订单进行计算？ 需求： 退款针对商品进行； 云私塾前段会有购物车的概念，用户可以通过一次支付购买多个商品； 解决方案： 如果鲨鱼的退款按照订单进行计算，则需要为每一个商品独立生成订单，如按照商品进行（电商结构）则不影响； 五、其他详细需求说明1.云私塾产品仅可在云私塾查看： 所有新东方在线网站等用户中心对应商品的展示规则： 所有涉及云私塾的项目，早期只能通过微信服务号进行访问并查看，已有的网站、APP等客户端中不进行相关显示； 购买相关产品的新东方在线用户，在“我”相关界面进行引导屏蔽，引导用户进入云私塾服务号； 目的：控制影响范围，将问题集中到我们这边来处理，便于快速调整优化； 2. 退款相关逻辑 问答的退款，云私塾后台自己来做，退款审核流程调用接口接入到鲨鱼的审核流程中； 资料的退款：调用鲨鱼的退款逻辑； 1v1的退款及结算待定； 3. 退款审批规则 退款的审批，由云私塾后台发起，接入鲨鱼系统的审批逻辑，结果同时返回到云私塾后台和鲨鱼后台； 云私塾发起退款，则鲨鱼对应的订单也完成退款；]]></content>
      <tags>
        <tag>鲨鱼对接</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[云私塾-研究生入驻产品需求文档说明书]]></title>
    <url>%2Fposts%2F7420%2F</url>
    <content type="text"><![CDATA[云私塾-研究生端需求说明文档文档说明： 文档版本号： 2.0.0 文档编号：yss-rz-2 YSS_PRD_2 文档密级： 内部文档 归属部门/项目： 国内考试事业部 产品名： 云私塾 子系统名： 研究生入驻及管理 编写人： 付荣 编写日期： 2018-09-28 页面原型地址如下：https://weixiaodeyu.github.io/yunsishu/ 文档更新概要2. 文档更新（2018-09-29）,文档编号yss-yz-2。 更新内容如下： 注册页授权逻辑修正，修正为从注册引导页进入注册页时拉取授权，感谢顾雪华老师（目录：三-1.3）； 研究生前端个人主页需求补充，感谢李龙、谢华、吕杨军老师（目录：三-2.3.1，详情见三-2.3.3）： 研究方向的选择，修改为在研究方向下拉选择时，同时完成研究方向和考试科目的选择； 考试科目根据研究方向的选择，进行自动填充，数量根据研究方向内的科目数进行调整； 1.用例评审后文档更新（2018-09-28），文档编号yss-yz-1。 重新完善了补充资料审核逻辑； 校准了对于认证入驻和补充资料审核的措辞如下： 认证入驻状态：认证通过、认证未通过、待认证、禁用 补充资料审核状态：审核通过、审核未通过 ==不作为研究生的身份状态，仅是当前提交的补充资料的状态。== 我的入驻信息页面进行修正： 修改逻辑增加了审核中的状态，补充信息提交后，待审核时用户无法再次修改； 增加了页面信息修改的逻辑流程图说明； 入驻审核和不从资料审核的审核结果通知，均通过微信模板消息完成，见4.3.2有消息模板。 以上，感谢！ 一、研究生端产品概述1. 概述根据项目产品规划，将项目产品区分为三个模块：考生端、研究生端、真题库，目前新东方不缺前端流量，只是我们没有办法提供相应的供给，所以优先开发供给端——研究生端。 前端系统： 研究生申请入驻（H5） 研究生个人主页（H5） 后端系统： 研究生入驻审核； 补充资料审核 研究生管理； 研究生入驻统计； 2. 相关角色 角色类型 角色描述 游客 进入服务号的访客，未完成研究生入驻申请； 认证通过研究生 完成研究生申请入驻，且入驻审核通过； 审核不通过研究生 完成研究生申请入驻，且未通过入驻审核； 待审核研究生 完成研究生申请入驻，后台尚未审核； 禁用研究生 被后端封禁的研究生； 管理员 云私塾管理员； 3.角色权限1表示可以访问。 页面名称/角色状态 游客 认证通过 审核不通过 待审核 禁用 注册引导页 1 1 注册页 1 1 1 注册完成页 1 1 个人主页 1 1 1 禁用提页面 1 4. 产品目标初步完成云私塾系统中，研究生申请入驻、个人信息管理、审核查询等基础功能的闭环，保证研究生能够高校快捷的进入到云私塾系统，完成云私塾研究生储备和管理。 二、研究生端产品结构1. 功能框架结构图 2. 数据定义及说明 序号 字段名称 数据定义 数据来源 数据使用场景 是否可修改 1 入驻时间 用户提交入驻申请的时间 记录用户第一次进入注册完成页的时间。 管理后台 不可修改 2 研究生ID（简称ID） 数据库中，研究生能的身份 新用户完成入驻申请后自动生成，Y00001开始自动生成。 研究生个人主页、管理后台 不可修改 3 昵称 用户微信昵称 抓取用户微信授权 考生端展示、研究生个人主页、管理后台 管理端可修改 4 头像 用户微信头像 抓取用户微信授权 考生端展示、研究生个人主页、管理后台 管理端可修改 5 性别 用户性别 默认抓取用户微信性别、用户可以在注册后个人主页选择 考生端展示、研究生个人主页、管理后台 个人主页可修改、管理端可修改 6 电话 用户的手机号码 注册页用户输入并验证有效性 研究生个人主页、管理后台 管理端可修改 7 院校所在省份 中国34个省 研招网数据库 所有数据检索结构、后台 管理端可修改 8 院校名称 研究生院校名称 研招网数据库 所有数据检索结构、后台、研究生个人主页、考生前端 管理端可修改 9 专业名称 研究生专业名称 研招网数据库 所有数据检索结构、后台、研究生个人主页、考生前端 管理端可修改 10 入学年份 研究生入学的年份 注册页选择（范围：2017-2020） 后台、研究生个人主页、考生前端 管理端可修改 11* 录取方式 研究生录取的形式 注册页选择第一志愿录取和调剂录取 后台、研究生个人主页、考生前端 管理端可修改 12 研究方向 读研时确定的研究方向 研招网数据库 后台、研究生个人主页、考生前端 管理端可修改 13 指导老师 研究生指导老师 用户个人主页输入 后台、研究生个人主页 管理端可修改 14 考研总分 研究生初试总成绩 用户个人主页输入 后台、研究生个人主页 管理端可修改 15 考试科目 研究生初试科目 研究生个人主页选择 后台、研究生个人主页、考生前端 管理端可修改 16 科目成绩 初试科目成绩 研究生个人主页输入 后台、研究生个人主页 管理端可修改 17* 原报考院校所在地 同7 个人主页选择 录取方式为“调剂录取”时增加该字段； 管理端可修改 18* 原报考院校名称 同8 个人主页选择 录取方式为“调剂录取”时增加该字段； 管理端可修改 19* 原报专业 同9 个人主页选择 录取方式为“调剂录取”时增加该字段； 管理端可修改 20* 初试科目 同15 个人主页选择 录取方式为“调剂录取”时增加该字段； 管理端可修改 21* 专业课成绩 同16 个人主页输入 录取方式为“调剂录取”时增加该字段； 管理端可修改 22 认证状态 认证未通过、认证通过、待认证、禁用、补充资料审核通过、补充资料审核未通过 后端规则设定 研究生个人主页、后台 管理端可修改 23 自我介绍 用户的个人介绍 用户个人主页输入 研究生个人主页、考生前端 个人主页可修改、管理端可修改 24 审核人 后端管理人员身份，特指研究生入驻的审核人（补充资料审核不记录审核人） 后端系统识别 研究生管理页面 不可修改 所有可以修改的数据，修改方式同产生方式（下拉选择、复选框、手动输入等）。 3. 主要业务流程 4. 页面原型页面原型地址如下：https://weixiaodeyu.github.io/yunsishu/ 三、研究生端1. 研究生入驻申请1.1 研究生申请入驻信息结构图 1.3 研究生申请入驻流程图 注册页，获取用户授权，拉取用户微信信息的逻辑图： 用户授权： 用户场景 用户从注册引导页进入注册页时拉取授权 功能描述 通过授权获取用户以下信息：微信头像、微信昵称、性别、位置等其他微信开放信息 需求描述 1.用户进入注册页时拉取授权，授权成功则进入页面；2.用户点击授权后成为授权用户；3.若用户未点击授权，再次点击”立即入驻“时重新拉取授权； 1.4 页面逻辑注册流程分为三个部分：注册页引导页、注册页、注册完成页，详情如下。 1.4.1注册引导页用途：此页的主要目的是让用户通过引导图的说明，清晰明了的知道我们是做什么的？入驻后能获得什么？快速建立用户认知。 页面分为两部分：1个底页，三张可滑动的图片。 页面详细说明： 需求详情： 图片向左滑动，图片不支持循环滚动； 滑动到最后一页继续往左滑动，自动进入注册页； 不进行图片操作，点击“立即入驻”仍可以直接进入注册页； 进入注册页前拉取用户授权； 1.4.2 注册页用途：此页主要用于研究生用户填写读研相关信息，完成信息的自动化录入，并通过系统审核后，成为系统内的合格研究生，向考生提供相关考研辅导。 页面Damon：具体交互请查看原型图的用例说明。 页面用例： 页面实际用例效果请参看原型图对应的页面，并按照页面提示点击对应的页面位置。 该页面主要为了获取研究生用户有效信息。具体需求如下： 在入驻信息的选择处：地区-院校-专业，按照父级关系逐级选择； 地区选择：点击院校所属省份后的输入框，调出以下页面； 院校选择：选择省份后，院校选择下面自动下拉调出以下页面（再次点击院校选择后的输入框可重新调出选择页）； 专业选择：选择院校后，自动打开专业选择（点击专业选择后面的输入框，也可以调出以下页面）； 证件上传： 限制最多上传5张照片； 文件类型：支持PNG、JPG等常见图片格式，单张图片最大10M； 点击上传，弹出提示语，点击“上传证件”后调取手机相册或拍照； 用户入驻后再次访问注册链接： 认证通过：正常访问； 待审核：直接进入注册完成页； 审核未通过：直接进入注册页，保留上次填写的缓存数据； 1.4.3 注册完成页该页面，主要引导用户在注册后进入其个人主页，先行熟悉系统，并趁着用户的热情还在，引导用户提交更多的资料信息。 需求详情：该页面，点击“我的主页”跳转“个人主页”，默认打开“我的入驻信息”页面； 此处因“录取方式”不同，进入个人主页后，页面内容不同； 第一志愿录取：进入个人主页-页面W1-1； 调剂录取：进入个人主页-页面W1-2； 1.5 数据需求 数据埋点 授权登录：点击取消人数、点击授权人数； 注册引导页访问PV/UV； 进入注册页人数； 进入注册完成页人数； 注册完成页面——“我的主页”点击人数； 数据缓存 新用户和审核未通过用户，访问注册页时，缓存注册页已输入的数据； 1.6 用户访问场景当用户访问注册链接时，判断用户身份，根据用户的认证状态，进入页面不同： 用户访问注册页的几种情况： 新用户：正常注册 认证状态为”认证通过”：进入个人主页 认证状态为”认证不通过”：进入注册页，缓存注册信息 认证状态为”待审核”：进入注册完成页 2. 研究生-个人主页2.1 个人主页信息结构图 2.2 个人主页页面结构 2.3 页面原型2.3.1 我的主页：W1 待认证、认证通过该页面支持全页向上滑动，用户输入时，唤起键盘后，自动将输入光标置于用户键盘上方。我的入驻信息相关详情见2.3.3。 页面需求详情： 页面前置条件：用户已完成入驻申请，证状态为“认证通过”、“认证未通过“、”待审核”均可访问； “我的入驻信息”进入信息补充页面（区分第一志愿录取及调剂录取），详情查看 2.3.3； 问题反馈界面： 2.3.2 我的主页：W2 认证未通过 需求详情： 页面前置条件：用户已完成入驻认证，且认证状态为“认证未通过”； 与“W1”不同处：该页面隐藏”我的入驻信息”菜单，显示“重新入驻菜单”， “重新入驻”菜单点击后进入“注册页”。 2.3.3 我的入驻信息页 访问权限：仅认证状态为“待认证”、“认证通过” 可访问我的“我的入驻信息界面“； 数据要求：所有信息必填，填写后方可提交；提交前进行数据验证，如发现空值，提示： 提交审核后的修改规则：当补充资料审核状态为“待审核”时，页面底部button变为“审核中”，“我的入驻信息”页面所有信息置灰,不可修改； 审核操作后的修改规则如下： 根据不同的前置条件，做对应的逻辑判断。 “我的入驻信息”页面 —— 第一志愿录取页面：信息项同W1-1的用例展示； “我的入驻信息”页面——调剂录取页面：信息项同W1-2的用例展示 3. 研究生管理后台3.1 研究生管理后台信息结构图主要完成研究生入驻相关信息的审核，信息结构如下。 后端需求： 后台保留每个管理员的所有操作日志，记录操作人、具体动作、操作日期，便于后期查证和管理； 后端的所有研究生管理类表格数据，后台支持按照筛选条件导出为Excel； 3.2 后端页面原型3.2.1 研究生入驻审核 入驻待审核列表，下图中的数据为示意，学校、专业显示全名，根据表格列宽进行省略，支持悬浮显示全称。 需求详情： 右上角：待认证处返回当前页面列表总人数； 排序：按照入驻时间倒序排列，入驻时间最近的在第一条； 审核页： 所有数据来源于用户前端注册数据及对应的微信数据，由服务器返回。 需求详情： 研究生ID：从Y00001默认连续生成； 有效证件和头像：图片点击可放大； 审核结果：认证通过、认证未通过 审核意见：根据审核结果的内容，审核意见调用”“内置选项（运营提供），同时支持手动输入； 审核结果通知： 认证通过：微信模板消息进行通知，模板跳转个人主页，见需求4.3.2 认证未通过：微信模板消息进行通知，模板跳转注册页重新入驻，见需求4.3.2 3.2.2 研究生补充资料审核 补充资料审核列表：学校、专业显示全名，根据表格列宽进行省略，支持悬浮显示全称。 该页面仅显示补充资料修改后，需要审核的信息条目，一旦审核操作完成，后台界面不保留审核记录，但在服务器保留审核日志（什么时间，谁审核的，审核结果），在有需要的时候可查即可。 审核逻辑： 此处主要审核研究生提交的补充资料，根据研究生认证状态不同，分为两个表格，默认显示待认证状态对应的表格： 1.待认证：刚完成入驻申请，管理员还未完成入驻审核； 2.认证通过：已完成入驻认证； 3.审核操作为（不影响入驻审核状态）： ​ 补充资料审核通过：新信息覆盖旧信息； ​ 补充资料审核未通过：驳回，保留原始信息； 备注： 认证状态为“禁用”、”审核未通过“的用户，不可修改自己的主页，所以这里不做考虑； 如用户在提交补充资料后，后台还未审核的时候重新提交补充资料审核，则自动覆盖上一条待审核内容，保留最新内容。 补充资料审核详情页面：区分录取方式“第一志愿”对应页面B1和“调剂录取”对应页面B2； 操作： ​ 补充资料审核通过：数据库更新其修改的数据； ​ 补充资料审核未通过：数据库不更新数据，并驳回； 3.2.3 研究生管理页面功能：该页面显示研究生入驻认证界面审核过的研究生数据，分为认证通过、认证未通过、禁用三个状态。 该页面分为三个状态：全部、认证通过、认证未通过、禁用（忽略补充资料审核状态），作为筛选tab. ​ 1.全部：含认证状态为待审核、认证通过、认证未通过、禁用 ==不包含待认证状态== ​ 2.认证通过：完成入驻且认证通过 ​ 3.认证未通过：入驻认证未通过（仅认证状态，不含补充资料审核状态） ​ 4.禁用：账户禁用； 表格样式如下：学校、专业显示全名，根据表格列宽进行省略，支持悬浮显示全称。 详情页面可修改用户状态（全部可修改）： 状态变更： 认证通过：将认证状态修改为认证通过，该状态时，研究生在学生端可见； 认证未通过：将认证状态修改为认证未通过，该状态时，研究生在学生端不可见； 禁用：将用户状态修改为禁用，该状态时，研究生在学生端不可见，且不可访问研究生端详情； 备注：以上状态修改，均不影响补充资料审核的状态及结果。 汇总数据： ​ 从数据库计算对应数据，并返回在这里，刷新页面时更新； 1. 共计完成研究生入驻总人数：全部tab下的所有人数，包含认证通过、认证未通过、禁用三个状态的人数； 2. 覆盖院校：这些研究生共计分布在多少个学校； 3. 认证通过：认证通过人数； 4. 认证未通过：认证未通过人数； 5. 禁用：禁用人数； 搜索： ​ 1.支持独立搜索和多字段联动搜索； ​ 2.入驻时间，支持时间选择； 3.2.4 研究生数据统计表该表，用来统计各大高校、各类状态研究生入驻的情况，便于市场调整入驻激励措施及推进方向。对应字段定义如下： 字段名称 定义 数据来源 序号 表示行数 自动生成 院校数量 系统中所有院校的总数 服务器计算返回 院校属性 院校是否为985/211/其他 数据库返回 专业数量 每个学校对应的专业总数 服务器计算返回 专业总数 学校数量*对应专业数量 服务器计算返回 认证通过研究生人数 对应高校认证通过的研究生人数 服务器计算返回 认证通过研究生人数 所有高校认证通过研究生的人数 服务器计算返回 第一志愿通过认证人数 认证通过人数中录取方式为第一志愿录取的人数 服务器计算返回 调剂认证通过人数 认证通过人数中录取方式为调剂录取的人数 服务器计算返回 覆盖专业数量 对应状态研究生所能覆盖的专业数量(去重后的数量） 服务器计算返回 总计 将下方对应各列数据求和 服务器计算返回 页面原型： 4. 其他需求4.1 性能需求 模块 场景 响应时间 成功率 并发 获取验证码 注册页获取验证码 &lt;3s 99.9% 10000 证件上传 注册页有效证件上传 &lt;3s 99.9% 10000 4.2 兼容性需求IOS端：兼容IOS最新版本经常用版本； Android：兼容安卓5.0版本及以上版本； 4.3 消息通知需求4.3.1 短信验证码目前涉及的短信验证码，为高频即时性需求，请走高速通道。 4.3.2 模板消息通知研究生在申请入驻时，审核通过、审核不通过均有对应模板消息进行通知。 通知场景：云私塾研究生之家 微信公众号平台对应账号为：koolearnyssxz@gmail.com 认证通过模板消息： 模板ID：iWSD1cAPKjN70Q4j7anEdAyp8wOPNa9DidcBIc6gFMQ 模板跳转：个人主页 消息内容： &gt; 同学您好，恭喜您成功入驻云私塾。&gt; 姓名：张三（抓取姓名）&gt; 专业：计算机（抓取入驻专业）&gt; 高校：北京邮电大学（抓取入驻学校信息）&gt; 审核通过时间：2018-05-14（抓取系统审核操作时间）&gt; 点击访问个人主页，可以完善更多信息，其他通能也将在我的主页陆续上线，敬请期待！如有任何疑问清理联系客服维系:XXXX。&gt; 认证未通过模板消息 模板ID：sFiEBitkYBIklOWRgK5ukDk1IM7_yaAO6WNQ4A7oKS8 模板跳转：注册页（缓存用户入驻信息） 消息内容 &gt; 您好，您的入驻审核未通过，原因如下，请修正后重新提交。&gt; 注册审核状态：审核不通过&gt; 审核时间：2018年2月23日（抓取审核操作时间）&gt; 审核备注：抓取后台审核意见详情&gt; 请按要求修正后重新提交。如有任何疑问请联系客服微信：XXXX。&gt; 禁用模板消息通知： 模板ID：sFiEBitkYBIklOWRgK5ukDk1IM7_yaAO6WNQ4A7oKS8 模板跳转：我的主页（禁用状态页面） 消息内容： &gt; 您好，您的账号已被禁用，具体情况请通过云私塾服务号咨询客服。&gt; 注册审核状态：禁用&gt; 审核时间：2018年2月23日（实际操作时间）&gt; 审核备注：抓取后台审核意见详情&gt; 如有任何疑问请联系客服微信：XXXX。&gt; 补充资料审核通过： 模板ID：imbsceJse76YNNR1aEZw7kFte1c-mc71ET8yBlkokeI 模板跳转：个人主页W1（W-1或W-2） 消息内容： &gt; 您好，您修改的信息已经通过审核！&gt; 审核内容：个人主页补充资料&gt; 审核结果：审核通过&gt; 抓取审核意见。&gt; 2014年7月21日&gt; 补充资料审核不通过： 模板ID：imbsceJse76YNNR1aEZw7kFte1c-mc71ET8yBlkokeI 模板跳转：个人主页W1（W-1或W-2） 消息内容： &gt; 您好，您的申请已审核完毕！&gt; 审核内容：个人主页补充资料&gt; 审核结果：审核不通过&gt; 抓取审核意见。&gt; 2014年7月21日&gt; 五、测试结果1. 前端小瑕疵 注册页院校选择部分：地区、院校等选择界面，上划动动作，与底层页面上划分离不明显，容易同时划动底层页面； 注册页图片上传部分：上传速度较慢，请问是否可以优化。点击上传后，页面静默大概3-5秒，才能完成图片上传，或者是否可以增加一个上传的过程，比如图片上面有个上传的进度圈？ 个人主页，认证状态： 此处指的是入驻审核的认证状态，感谢。 2. 管理后台2.1 研究生数据统计模块 数据定义： 覆盖专业数量：指的是前一列对应状态的研究生人数所覆盖的专业数量；该页面所有统计数据，不计算认证未通过的人数。 小需求： 是否可以将前两行的总计数据，与下方的各分校的数据列进行对齐？ 前两行好像多了一列？ 该页面请协助添加数据导出为EXCEL的功能，感谢！ 2.2 研究生管理 详情页面无法访问，点击后空白； 请将表格字段“审核”修改为“认证状态”； 对应的认证状态为：认证通过、认证不通过、待认证、禁用 “禁用”条件的筛选结果不正确，录取方式筛选好像也不准（不知道是不是因为在测试环境的原因）； 需求：院校和专业筛选，是否可以支持模糊搜索（输入关键词自动给出匹配结果列表，可以选择） 2.3 补充资料审核 补充资料审核部分，有字段冗余，请协助查验。 2.3 其他 后台管理列表的序号：指的是当前页自然排序的序号，便于看出当前页的数据个数，非固定参数； 入驻审核通过、补充资料审核通过这两个口，建议是否可以和审核驳回一样，弹出对应的消息框，支持预置和手动输入；]]></content>
      <tags>
        <tag>研究生入驻管理</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[研招网院校库数据扒取]]></title>
    <url>%2Fposts%2F35732%2F</url>
    <content type="text"><![CDATA[引子：全局术语 术语名称 名词属性 术语详情 招生院校 学校名称、学校代代码全局唯一 具备研究生招生资格的高校名称 学科门类 13个学科门类，代码全局唯一 学科门类是对具有一定关联学科的归类，是授予学位的学科类别。规定我国分为哲学、经济学、法学、教育学、文学、历史学、理学、工学、农学、医学、军事学、管理学、艺术学13个学科门类 学科类别（分一级和二级） 代码全局唯一 学科类别分为一级学科和二级学科。一级学科：每个学科门类下分不同的一级学科，约为110个（不含军事学）二级学科：每个一级学科下又分为很多二级学科，==即为常说的专业==，约为375个； 研究方向 — 每个专业因教授不同，其又有很多细分领域，部分高校在报考时选择，部分高校在入学后选择。 考研年份 — 参加研究生考试的年份 研究生入学年份 — 研究生入学的年份，一般比考研年份大一年 统招属性 — 统招第一志愿录取：通过统考，直接被第一志愿录取（研究生考试只能填报一个志愿）调剂录取：为考生目标高校，选择其他高校就读（存在跨专业调剂、本专业调剂的多种情况），调剂考生对于专业课辅导基本没有作用，其等同于没考上。 考试科目 学校层级下，每个考试科目唯一 研究生考试内容分为四科：两门公共课（统一命题）：政治（100分）、英语（100分）一门基础课：数学（全国统一命题，150分）或专业基础课（150分）一门专业课：专业知识（150分）PS：联考类综合等属于另外一类，这里不做赘述。 一、需求详情为了便于后台数据的联通，需要搭建一个标准化、通用版的底层数据标准，根据实际需求，选用研招网的院校科目作为底层的数据框架。 1.信息来源：网址：https://yz.chsi.com.cn/sch/ 2.信息获取方式： 技术爬虫 3.需求详情： 保留数据之间的层级结构； 业务课中如出现“或”的关系，则层级关系中也保留或的关系（见样式图说明）。 4.表格样式： 地区 招生单位 院校特性 学科门类 学科类别 院系所 专业 研究方向 学习方式 招生人数 业务课1 业务课2 北京 北京大学 985/211 哲学 西方哲学 哲学 西方哲学史 有则填充数据，无则为空 全日制 院系所：250推免：195 (833)哲学史 (823)哲学 5.研招网原始数据样式图说明： 一级页面地址：https://yz.chsi.com.cn/zsml/queryAction.do 二级页面地址：https://yz.chsi.com.cn/zsml/querySchAction.do?ssdm=11&amp;dwmc=%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6&amp;mldm=01&amp;mlmc=&amp;yjxkdm=0101&amp;xxfs=&amp;zymc= 三级页面地址：https://yz.chsi.com.cn/zsml/kskm.jsp?id=1000121023010101011 二、数据的预期使用逻辑 三、数据的维护更新1.不随时间变化的字段 地区：不变 院校：不变，可能会增加或减少 学科门类：值与数量都不变 学科类别：一级，值与数量都不变 专业：值与数量都不变 专业中有少部分可能变动，主要为军校，暂时可以忽略。 2.数据维护频率每年一次，每年10月份重新扒取一起，按照唯一字段进行全局对比]]></content>
      <tags>
        <tag>云私塾</tag>
      </tags>
  </entry>
</search>
